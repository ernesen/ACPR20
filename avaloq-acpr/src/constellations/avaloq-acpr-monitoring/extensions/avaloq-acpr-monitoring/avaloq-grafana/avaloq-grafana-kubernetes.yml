apiVersion: avaloq/v1
kind: AvaloqFiles
spec:
  parameters:
  - name: grafana-configuration/grafana-datasource.yml
    validation:
      required: false
      type: text
    value: |
      apiVersion: 1
      datasources:
       - name: DS-Prometheus
         type: prometheus
         access: proxy
         orgId: 1
         url: http://prometheus-direct:9090
         version: 1
         isDefault: true
         editable: true
         basicAuth: false
  - name: grafana-configuration/additional-dashboard-provisioning.yaml
    validation:
      required: false
      type: text
    value: |
      # This file contains additional Grafana dashboard provisioners
  - name: grafana-configuration/htpasswd
    validation:
      required: true
      type: text
    value: |
      # This file contains credentials used to login to Grafana
---
apiVersion: avaloq/v1
kind: AvaloqParameters
spec:
  parameters:
  - name: OPENSHIFT_VERSION
    validation:
      required: true
      type: number
      range:
        min: 3
        max: 4
    description: OpenShift version where this constellation is deployed to. Valid
      values are 3 or 4.
    value: 4
  - name: OPENSHIFT_NAMESPACE
    validation:
      type: text
      required: true
    description: The namespace used on Openshift where this constellation is deployed
      to.
    value: acpr-monitoring
  - name: AVALOQ_REDHAT_CONTAINER_IMAGE_REGISTRY
    validation:
      type: text
      required: false
    value: registry.service.avaloq.com/
    description: |
      URL of the container image registry containing the Red Hat images. Must end with "/", unless you set it to null
  - name: AVALOQ_CONTAINER_IMAGE_REGISTRY
    validation:
      required: false
      type: text
    value: registry.service.avaloq.com/
    description: URL of the container image registry. Must end with "/", unless you
      set it to null
  - name: AVALOQ_GRAFANA_DEPLOY_SECRET
    validation:
      type: text
      required: true
    value: true
    description: Set to 'false' if you don't want to deploy secrets. It can be useful
      when using Sealed Secrets
  - name: AVALOQ_GRAFANA_ALERTS
    validation:
      type: text
      required: true
    value: true
    description: Enables or disable deploy of Grafana alerts
  - name: AVALOQ_GRAFANA_DEPLOY_PVC
    validation:
      type: text
      required: true
    value: true
    description: Set to 'false' if you don't want to deploy PVCs
  - name: AVALOQ_GRAFANA_SESSION_SECRET
    validation:
      type: text
      required: true
    description: Secret string used to encrypt sessions
  - name: AVALOQ_GRAFANA_SHOW_HTPASSWD_FORM
    validation:
      type: text
      required: false
    value: false
    description: Show or hide htpasswd form in Grafana proxy
  - name: AVALOQ_GRAFANA_CONTAINER_IMAGE_PULL_POLICY
    value: IfNotPresent
    validation:
      required: false
      type: text
      pattern: ^(IfNotPresent)|(Always)$
    description: |
      The pull policy to use for the container image. Valid values are `IfNotPresent` and `Always`, default is `IfNotPresent`.
  - name: AVALOQ_GRAFANA_ROUTE_HOSTNAME
    validation:
      type: text
      required: false
    value: null
    description: |
      Select a hostname to use to access Grafana. If empty, OpenShift generates the hostname automatically.
  - name: AVALOQ_GRAFANA_REPLICAS
    validation:
      type: number
      required: false
      range:
        min: 0
    value: 1
    description: Number of replicas of Grafana deployment
  - name: AVALOQ_GRAFANA_CONTAINER_IMAGE
    validation:
      type: text
      required: false
    value: openshift3/grafana:v3.11.465
    description: Container image of Grafana
  - name: AVALOQ_GRAFANA_PROXY_CONTAINER_IMAGE
    validation:
      type: text
      required: false
    value: openshift3/oauth-proxy:v3.11.465
    description: Container image of Grafana proxy
  - name: AVALOQ_GRAFANA_NODE_SELECTOR_KEY
    validation:
      type: text
      required: false
    value: dummySelector
    description: Specify a node where Grafana is deployed
  - name: AVALOQ_GRAFANA_NODE_SELECTOR_VALUE
    validation:
      type: text
      required: false
    value: true
    description: Specify a node where Grafana is deployed
  - name: AVALOQ_GRAFANA_VOLUME_HOSTPATH_LIBRARY
    validation:
      type: text
      required: false
    description: Grafana hostpath path for lib/ folder
  - name: AVALOQ_GRAFANA_VOLUME_HOSTPATH_DASHBOARD
    validation:
      type: text
      required: false
    description: Grafana hostpath path for dashboards folder
  - name: AVALOQ_GRAFANA_SECURITYCONTEXT_PRIVILEGED
    validation:
      type: text
      required: false
    value: false
    descritpion: Run Grafana pods as privileged
  - name: AVALOQ_GRAFANA_SECURITYCONTEXT_RUNASUSER
    validation:
      type: number
      required: false
      range:
        min: 1000
    value: null
    description: Grafana prviledged user id
  - name: AVALOQ_GRAFANA_PVC_STORAGE_REQUEST_LIBRARY
    validation:
      type: text
      required: false
    value: 1Gi
    description: Grafana storage request for storing libraries (i.e. sqlite database)
  - name: AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_LIBRARY
    validation:
      type: text
      required: false
    description: Grafana PersitentVolumeClaim library storage class name
  - name: AVALOQ_GRAFANA_PVC_STORAGE_ACCESSMODE_LIBRARY
    validation:
      type: text
      required: false
    value: ReadWriteOnce
    description: Grafana PersitentVolumeClaim library access mode
  - name: AVALOQ_GRAFANA_PVC_STORAGE_REQUEST_DASHBOARD
    validation:
      type: text
      required: false
    value: 1Gi
    description: Grafana storage request for storing dashboards
  - name: AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_DASHBOARD
    validation:
      type: text
      required: false
    description: Grafana PersitentVolumeClaim log storage class name
  - name: AVALOQ_GRAFANA_PVC_STORAGE_ACCESSMODE_DASHBOARD
    validation:
      type: text
      required: false
    value: ReadWriteMany
    description: Grafana PersitentVolumeClaim dashboards access mode
  - name: AVALOQ_GRAFANA_PODANTIAFFINITY_TOPOLOGY_KEY
    validation:
      type: text
      required: false
    description: Grafana pod antiaffinity topology key
  - name: AVALOQ_GRAFANA_RESOURCES_LIMIT_CPU
    validation:
      type: text
      required: false
    value: 200m
    description: Grafana CPU limit
  - name: AVALOQ_GRAFANA_RESOURCES_REQUEST_CPU
    validation:
      type: text
      required: false
    value: 75m
    description: Grafana memory request
  - name: AVALOQ_GRAFANA_RESOURCES_LIMIT_MEMORY
    validation:
      type: text
      required: false
    value: 256Mi
    description: Grafana memory limit
  - name: AVALOQ_GRAFANA_RESOURCES_REQUEST_MEMORY
    validation:
      type: text
      required: false
    value: 256Mi
    description: Grafana memory request
  - name: AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_CPU
    validation:
      type: text
      required: false
    value: 50m
    description: Grafana proxy CPU limit
  - name: AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_CPU
    validation:
      type: text
      required: false
    value: 10m
    description: Grafana proxy CPU request
  - name: AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_MEMORY
    validation:
      type: text
      required: false
    value: 256Mi
    descritpion: Grafana proxy memory limit
  - name: AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_MEMORY
    validation:
      type: text
      required: false
    value: 256Mi
    description: Grafana proxy memory request
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_CONTAINER_IMAGE
    validation:
      type: text
      required: false
    value: avaloq/avaloq-grafana-dashboard-provisioner:0.6.4
    descritpion: Container image of Grafana Dashboard Provisioner
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_ADDITIONAL_DASHBOARD_TYPES
    validation:
      type: text
      required: false
      pattern: ^(,[a-z0-9]+)+$
    description: |
      Additional dashboard types processed by this provisioner. Every name must start with comma. For instance ',custom1,custom2'
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_REPLICAS
    validation:
      type: number
      required: false
      range:
        min: 0
    value: 1
    description: Number of replicas of Grafana Dashboard Provisioner
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_NODE_SELECTOR_KEY
    validation:
      type: text
      required: false
    value: dummySelector
    descritpion: Specify a node where Grafana Dashboard is deployed
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_NODE_SELECTOR_VALUE
    validation:
      type: text
      required: false
    value: true
    description: Specify a node where Grafana Dashboard is deployed
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_VOLUME_HOSTPATH_DASHBOARD
    validation:
      type: text
      required: false
    description: Grafana Dashboard Provisioner hostpath for dashboards
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_SECURITYCONTEXT_PRIVILEGED
    validation:
      type: text
      required: false
    value: false
    description: Run Grafana Dashboard Provisioner as a privileged user
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_SECURITYCONTEXT_RUNASUSER
    validation:
      type: number
      required: false
      range:
        min: 1000
    value: null
    description: Grafana Dashboard Provisioner prviledged user id
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_PODANTIAFFINITY_TOPOLOGY_KEY
    validation:
      type: text
      required: false
    description: Grafana Dashboard provsioner pod antiaffinity topology configuration
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_CPU
    validation:
      type: text
      required: false
    value: 25m
    description: Grafana Dashboard Provisioner CPU request
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_MEMORY
    validation:
      type: text
      required: false
    value: 512Mi
    description: Grafana Dashboard Provisioner memory limit
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_MEMORY
    validation:
      type: text
      required: false
    value: 512Mi
    description: Grafana Dashboard Provisioner memory request
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_CPU
    validation:
      type: text
      required: false
    value: 200m
    description: Grafana Dashboard Provisioner CPU limit
  - name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_LOGGING_LEVELS
    validation:
      required: false
      type: text
    value: LOGGING_LEVEL=info
    description: |
      Comma-separated list of custom logging levels per logger. Logger names must be written in snake_case, logging levels as defined by log4j2. Example: "COM_AVALOQ=WARN,ORG_THIRDPARTY=ERROR"
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-node-selector
    when:
      matching:
        kind: Deployment
        metadata.name: grafana
      condition: params.getOrDefault('AVALOQ_GRAFANA_NODE_SELECTOR_KEY', '') == "dummySelector"
    then:
    - action: delete
      path: spec.template.spec.nodeSelector
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-route
    when:
      matching:
        kind: Route
        metadata.name: grafana
      condition: params.getOrDefault('AVALOQ_GRAFANA_ROUTE_HOSTNAME', '').isEmpty()
    then:
    - action: delete
      path: spec.host
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-lib-pvc-storageclass
    when:
      matching:
        kind: PersistentVolumeClaim
        metadata.name: grafana-lib-pvc
      condition: params.getOrDefault('AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_LIBRARY',
        '').isEmpty()
    then:
    - action: delete
      path: spec.storageClassName
  - name: grafana-dashboards-volume-storageclass
    when:
      matching:
        kind: PersistentVolumeClaim
        metadata.name: grafana-dashboards-volume
      condition: params.getOrDefault('AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_DASHBOARD',
        '').isEmpty()
    then:
    - action: delete
      path: spec.storageClassName
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-dashboard-provisioner-node-selector
    when:
      matching:
        kind: Deployment
        metadata.name: grafana-dashboard-provisioner
      condition: params.getOrDefault('AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_NODE_SELECTOR_KEY',
        '') == "dummySelector"
    then:
    - action: delete
      path: spec.template.spec.nodeSelector
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-dashboard-provisioner-affinity
    when:
      matching:
        kind: Deployment
        metadata.name: grafana-dashboard-provisioner
      condition: params.getOrDefault('AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_PODANTIAFFINITY_TOPOLOGY_KEY',
        '').isEmpty()
    then:
    - action: delete
      path: spec.template.spec.affinity
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-affinity
    when:
      matching:
        kind: Deployment
        metadata.name: grafana
      condition: params.getOrDefault('AVALOQ_GRAFANA_PODANTIAFFINITY_TOPOLOGY_KEY',
        '').isEmpty()
    then:
    - action: delete
      path: spec.template.spec.affinity
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-dashboard-provisioner-hostpath
    when:
      matching:
        kind: Deployment
        metadata.name: grafana-dashboard-provisioner
    then:
    - action: apply
      script: |
        def processVolume(volumeName, hostPath) {
          volumes = $.spec.template.spec.volumes;
          for (int i = 0; i < volumes.size(); i++) {
            if (volumes[i].name == volumeName ) {
              volumes.remove(i);
              volumes.add(i, ["name": volumeName, "hostPath": ["type": "", "path": hostPath]]);
            }
          }
          $.spec.template.spec.volumes = volumes;
        }
        if ('${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_VOLUME_HOSTPATH_DASHBOARD}'.length() > 0) {
          processVolume('grafana-dashboards-volume', '${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_VOLUME_HOSTPATH_DASHBOARD}');
        }
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-hostpath
    when:
      matching:
        kind: Deployment
        metadata.name: grafana
    then:
    - action: apply
      script: |
        def processVolume(volumeName, hostPath) {
          volumes = $.spec.template.spec.volumes;
          for (int i = 0; i < volumes.size(); i++) {
            if (volumes[i].name == volumeName ) {
              volumes.remove(i);
              volumes.add(i, ["name": volumeName, "hostPath": ["type": "", "path": hostPath]]);
            }
          }
          $.spec.template.spec.volumes = volumes;
        }
        if ('${AVALOQ_GRAFANA_VOLUME_HOSTPATH_LIBRARY}'.length() > 0) {
          processVolume('grafana-lib-pvc', '${AVALOQ_GRAFANA_VOLUME_HOSTPATH_LIBRARY}');
        }
        if ('${AVALOQ_GRAFANA_VOLUME_HOSTPATH_DASHBOARD}'.length() > 0) {
          processVolume('grafana-dashboards-volume', '${AVALOQ_GRAFANA_VOLUME_HOSTPATH_DASHBOARD}');
        }
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: disable-dashboards-in-openshift4
    when:
      matching:
        kind: ConfigMap
        metadata.labels["dashboard-type"]: infrastructure
      condition: params.getOrDefault('OPENSHIFT_VERSION', '') == 4
    then:
    - action: apply
      script: |-
        if ($.metadata.get("annotations") == null) {
          $.metadata.put("annotations", new java.util.HashMap());
        }
        $.metadata.annotations.put("installator.avaloq.com/ignore", "always");
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-resources
    when:
      matching:
        kind: Deployment
        metadata.name: grafana
    then:
    - action: apply
      script: |
        def processResource(containerName, kind, type) {
          containers = $.spec.template.spec.containers;
          for (int i = 0; i < containers.size(); i++) {
            if (containers[i].name == containerName ) {
              containers[i].resources[kind].remove(type);
            }
          }
        }

        if ('${AVALOQ_GRAFANA_RESOURCES_LIMIT_CPU}' == '') {
          processResource('grafana', 'limits', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_RESOURCES_LIMIT_MEMORY}' == '') {
          processResource('grafana', 'limits', 'memory');
        }

        if ('${AVALOQ_GRAFANA_RESOURCES_REQUEST_CPU}' == '') {
          processResource('grafana', 'requests', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_RESOURCES_REQUEST_MEMORY}' == '') {
          processResource('grafana', 'requests', 'memory');
        }

        if ('${AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_CPU}' == '') {
          processResource('grafana-proxy', 'limits', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_MEMORY}' == '') {
          processResource('grafana-proxy', 'limits', 'memory');
        }

        if ('${AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_CPU}' == '') {
          processResource('grafana-proxy', 'requests', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_MEMORY}' == '') {
          processResource('grafana-proxy', 'requests', 'memory');
        }
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-provisioner-resources
    when:
      matching:
        kind: Deployment
        metadata.name: grafana-dashboard-provisioner
    then:
    - action: apply
      script: |
        def processResource(containerName, kind, type) {
          containers = $.spec.template.spec.containers;
          for (int i = 0; i < containers.size(); i++) {
            if (containers[i].name == containerName ) {
              containers[i].resources[kind].remove(type);
            }
          }
        }

        if ('${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_CPU}' == '') {
          processResource('grafana-dashboard-provisioner', 'limits', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_MEMORY}' == '') {
          processResource('grafana-dashboard-provisioner', 'limits', 'memory');
        }

        if ('${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_CPU}' == '') {
          processResource('grafana-dashboard-provisioner', 'requests', 'cpu');
        }

        if ('${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_MEMORY}' == '') {
          processResource('grafana-dashboard-provisioner', 'requests', 'memory');
        }
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: grafana-provisioner-logging-level
    when:
      matching:
        kind: Deployment
        metadata.name: grafana-dashboard-provisioner
      parameter: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_LOGGING_LEVELS
    then:
    - action: env
      parameter:
        name: AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_LOGGING_LEVELS
      container:
        name: grafana-dashboard-provisioner
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: disable-secrets
    when:
      matching:
        kind: Secret
      condition: params.getOrDefault('AVALOQ_GRAFANA_DEPLOY_SECRET', '') == false
    then:
    - action: apply
      script: |-
        if ($.metadata.get("annotations") == null) {
          $.metadata.put("annotations", new java.util.HashMap());
        }
        $.metadata.annotations.put("installator.avaloq.com/ignore", "always");
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: disable-pvcs
    when:
      matching:
        kind: PersistentVolumeClaim
      condition: params.getOrDefault('AVALOQ_GRAFANA_DEPLOY_PVC', '') == false
    then:
    - action: apply
      script: |-
        if ($.metadata.get("annotations") == null) {
          $.metadata.put("annotations", new java.util.HashMap());
        }
        $.metadata.annotations.put("installator.avaloq.com/ignore", "always");
---
apiVersion: avaloq/v1
kind: AvaloqPatch
spec:
  patches:
  - name: disable-grafana-alerts
    when:
      matching:
        kind: ConfigMap
        metadata.name: grafana-alerts
      condition: params.getOrDefault('OPENSHIFT_VERSION', '') == 3 || params.getOrDefault('AVALOQ_GRAFANA_ALERTS',
        '') == false
    then:
    - action: apply
      script: |-
        if ($.metadata.get("annotations") == null) {
          $.metadata.put("annotations", new java.util.HashMap());
        }
        $.metadata.annotations.put("installator.avaloq.com/ignore", "always");
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: dashboard-provisioner-configmap-viewer
  labels:
    avaloq.com/app: grafana-dashboard-provisioner
    app.kubernetes.io/component: monitoring
rules:
- apiGroups:
  - ''
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: dashboard-provisioner-configmap-viewer
  labels:
    avaloq.com/app: grafana-dashboard-provisioner
    app.kubernetes.io/component: monitoring
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: dashboard-provisioner-configmap-viewer
subjects:
- kind: ServiceAccount
  name: grafana-dashboard-provisioner
  namespace: acpr-monitoring
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-cluster-cpu-load-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "Summary of OpenShift Cluster CPU load",
      "editable": true,
      "gnetId": null,
      "graphTooltip": 1,
      "id": 3511596,
      "iteration": 1588932259079,
      "links": [],
      "panels": [
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 0
          },
          "id": 10,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "topk(10, rate(container_cpu_usage_seconds_total{instance=\"[[Node]]\", id!=\"/\", container_name!=\"POD\", container_name=~\".+\"}[5m]))",
              "format": "time_series",
              "interval": "15s",
              "intervalFactor": 1,
              "legendFormat": "{{namespace}}/{{pod_name}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pods CPU usage on [[Node]]",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "cores",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 0
          },
          "id": 6,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(increase(kube_pod_container_status_restarts_total[5m]))",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "restarts",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pod restart count rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "OpenShift internal core components CPU usage",
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 9
          },
          "id": 4,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(container_cpu_usage_seconds_total{instance=\"[[Node]]\", pod_name=~\"master-.*|sync-.*|sdn-.*|ovs-.*|logging-fluentd-.*\", container_name!=\"POD\", container_name=~\".+\"}[5m])",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{container_name}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "OpenShift pods CPU usage on [[Node]]",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "cores",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "decimals": null,
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 9
          },
          "id": 8,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideZero": false,
            "max": false,
            "min": false,
            "rightSide": true,
            "show": true,
            "sideWidth": null,
            "sort": "avg",
            "sortDesc": true,
            "total": true,
            "values": true
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "topk(15, sum(irate(apiserver_request_count{verb=~\"UPDATE|DELETE|DELETECOLLECTION|PATCH|PUT\"}[5m])) by (resource))",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{resource}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "API requests",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 18
          },
          "id": 12,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "node_load5{instance=\"[[Node]]\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "load5",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "[[Node]] load 5m",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 18
          },
          "id": 14,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "node_load5",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{instance}}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Nodes load 5m",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "fill": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 27
          },
          "id": 2,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 1,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum (rate (container_cpu_usage_seconds_total{container_name!=\"POD\", container_name=~\".+\", instance=\"[[Node]]\"}[5m])) / sum (machine_cpu_cores{instance=\"[[Node]]\"}) * 100",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "containersCPU%",
              "refId": "C"
            },
            {
              "expr": "100 - (avg by (instance) (rate(node_cpu_seconds_total{job=\"node-exporters\",instance=\"[[Node]]\",mode=\"idle\"}[5m])) * 100)",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "nodeCPU%",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "CPU usage on [[Node]]",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": null,
            "datasource": "DS-Prometheus",
            "definition": "label_values(kube_node_info, node)",
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "Node",
            "options": [],
            "query": "label_values(kube_node_info, node)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-1h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Dashboard: OpenShift Cluster CPU Load",
      "uid": "acpr-cluster-cpu-load",
      "version": 1
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-cluster-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "Summary of OpenShift Cluster health",
      "editable": true,
      "gnetId": 6417,
      "graphTooltip": 1,
      "id": 546606,
      "iteration": 1568894155863,
      "links": [
        {
          "asDropdown": true,
          "icon": "external link",
          "includeVars": true,
          "keepTime": false,
          "tags": [
            "kubernetes-app"
          ],
          "title": "Dashboards",
          "type": "dashboards"
        }
      ],
      "panels": [
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 22,
          "panels": [],
          "title": "Cluster",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Overall cluster load (_load 1_) of all cluster nodes \n(incl. _application_ and _infra_ nodes)",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 0,
            "y": 1
          },
          "id": 61,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": " (sum(max(node_load1 ) by (instance)) / sum (max(machine_cpu_cores) by (instance))/ sum(max(machine_cpu_cores)) ) * 100",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "75,90",
          "title": "Cluster Load",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "decimals": null,
          "description": "Overall memory consumption of all cluster nodes \n(incl. _application_ and _infra_ nodes)",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 6,
            "y": 1
          },
          "id": 59,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "(sum(node_memory_MemTotal_bytes) - sum(node_memory_MemFree_bytes+node_memory_Buffers_bytes+node_memory_Cached_bytes) ) / sum(node_memory_MemTotal_bytes) * 100",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "75,90",
          "title": "Cluster Memory Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Overall file system usage of all cluster nodes \n(incl. _application_ and _infra_ nodes)",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 12,
            "y": 1
          },
          "id": 63,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "100 - 100* (sum (node_filesystem_avail_bytes{device!~'tmpfs'}) / sum(node_filesystem_size_bytes{device!~'tmpfs'}))",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "70,90",
          "title": "Cluster Filesystem Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "decimals": null,
          "description": "Pods in _running_ state in relation to overall cluster pod capacity (incl. _application_ and _infra_ nodes)",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 18,
            "y": 1
          },
          "id": 65,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "100 / sum(kube_node_status_capacity_pods) * sum(kube_pod_status_phase{phase=\"Running\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "75,95",
          "title": "Cluster Pod Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 8
          },
          "id": 69,
          "panels": [],
          "title": "Nodes",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total number of OpenShift Cluster nodes ( _master_, _infra_ and _application_ nodes)",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 18,
            "x": 0,
            "y": 9
          },
          "id": 24,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_node_info)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Total Number of Nodes",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": true,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "OpenShift cluster nodes that are not reachable",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 18,
            "y": 9
          },
          "id": 26,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_node_spec_unschedulable)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            },
            {
              "expr": "",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "B"
            }
          ],
          "thresholds": "1",
          "title": "Nodes Unavailable",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total number of OpenShift _application_ nodes which can be used for Application workload",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 12
          },
          "id": 51,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(node_uname_info{node_role_kubernetes_io_compute=\"true\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Number of Application Nodes",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": true,
          "colors": [
            "#d44a3a",
            "rgba(237, 129, 40, 0.89)",
            "rgba(255, 255, 255, 0.8)"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total number of OpenShift _master_ nodes. In ACPR compliant cluster installations this should be _3_",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 6,
            "y": 12
          },
          "id": 53,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(node_uname_info{node_role_kubernetes_io_master=\"true\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "2,3",
          "title": "Number of Master Nodes",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": true,
          "colors": [
            "#d44a3a",
            "rgba(237, 129, 40, 0.89)",
            "rgba(255, 255, 255, 0.8)"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total number of OpenShift _infra_ nodes which can  be used for cluster-wide services such as _OpenShift Router_. In ACPR compliant cluster installations this should be at least _3_",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 12,
            "y": 12
          },
          "id": 55,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(node_uname_info{node_role_kubernetes_io_infra=\"true\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1,2",
          "title": "Number of Infrastructure Nodes",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": true,
          "colorPrefix": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "OpenShift cluster nodes that are reachable but marked as _NotReady_ from OpenShift perspective",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 18,
            "y": 12
          },
          "id": 57,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "#d683ce",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_node_info) - sum(node_uname_info{beta_kubernetes_io_os=\"linux\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1",
          "title": "Nodes NotReady",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 15
          },
          "id": 28,
          "panels": [],
          "title": "Pods",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _running_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 16
          },
          "id": 30,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "  rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "  rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_status_phase{phase=\"Running\"})",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Pods Running",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _pending_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 6,
            "y": 16
          },
          "id": 31,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": " rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "  rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_status_phase{phase=\"Pending\"})",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Pods Pending",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": true,
          "colorValue": false,
          "colors": [
            "rgb(41, 156, 70)",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _failed_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 12,
            "y": 16
          },
          "id": 32,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(78, 203, 42, 0.28)",
            "full": false,
            "lineColor": "#629e51",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_status_phase{phase=\"Failed\"})",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1,1",
          "title": "Pods Failed",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": true,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _unknown_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 18,
            "y": 16
          },
          "id": 34,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(78, 203, 42, 0.28)",
            "full": false,
            "lineColor": "#629e51",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_status_phase{phase=\"Unknown\"})",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1,1",
          "title": "Pods Unknown",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 19
          },
          "id": 36,
          "panels": [],
          "title": "Containers",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of containers in _running_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 0,
            "y": 20
          },
          "id": 38,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_container_status_running)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Containers Running",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _waiting_ state throughout the entire cluster",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 6,
            "y": 20
          },
          "id": 39,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_container_status_waiting)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Containers Waiting",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of pods in _terminated_ state throughout the entire cluster. \n\nThis can be due to successful execution (e.g. _openshift-logging_ curator- pod) or a failure during execution.",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 12,
            "y": 20
          },
          "id": 40,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(kube_pod_container_status_terminated)",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Containers Terminated",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "rgba(41, 156, 70, 0)",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "decimals": null,
          "description": "Number of container restarts during last 30 minutes",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 6,
            "x": 18,
            "y": 20
          },
          "id": 41,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(delta(kube_pod_container_status_restarts_total[30m]))",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Containers Restarts (Last 30 Minutes)",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "current": {
              "text": "No data sources found",
              "value": ""
            },
            "hide": 2,
            "label": "",
            "name": "datasource",
            "options": [],
            "query": "prometheus",
            "refresh": 1,
            "regex": "/$ds/",
            "skipUrlSync": false,
            "type": "datasource"
          }
        ]
      },
      "time": {
        "from": "now-24h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "Topic: OpenShift Cluster",
      "uid": "acpr-cluster-dashboard",
      "version": 2
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-elasticsearch-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "This dashboard is designed to collect information about the Openshift logging framework which is based on Elasticsearch",
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": 30015,
      "iteration": 1571914782483,
      "links": [],
      "panels": [
        {
          "collapsed": false,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 12,
          "panels": [],
          "title": "Overall status",
          "type": "row"
        },
        {
          "cacheTimeout": null,
          "colorBackground": true,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "description": "0 => Green, cluster OK all primary and replicas shards present\n1 => Yellow, Some replicas shards are missing, but all data is available\n2 => Red, Some data is missing\nHere, max is used in the expression because 3 data nodes have the same value",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 4,
            "x": 0,
            "y": 1
          },
          "id": 6,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "max(es_cluster_status{job=~\"$job\", cluster=~\"$cluster\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1,2",
          "title": "Cluster status - $cluster",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "Cluster OK",
              "value": "0"
            },
            {
              "op": "=",
              "text": "Some Problem",
              "value": "1"
            },
            {
              "op": "=",
              "text": "Severe Problem",
              "value": "2"
            }
          ],
          "valueName": "current"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 5
          },
          "id": 84,
          "panels": [
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": true,
              "colors": [
                "#d44a3a",
                "rgba(237, 129, 40, 0.89)",
                "#299c46"
              ],
              "description": "Contains the total value of the nodes in the cluster.\nMax is used because 3 data nodes have the same value.",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 0,
                "y": 6
              },
              "id": 2,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "max(es_cluster_nodes_number{job=~\"$job\", cluster=~\"$cluster\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "1,3",
              "title": "Total number of nodes in the cluster - $cluster",
              "type": "singlestat",
              "valueFontSize": "110%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": true,
              "colors": [
                "#d44a3a",
                "rgba(237, 129, 40, 0.89)",
                "#299c46"
              ],
              "description": "Contains the total value of data nodes in the cluster.",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 8,
                "y": 6
              },
              "id": 8,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "max(es_cluster_datanodes_number{job=~\"$job\", cluster=~\"$cluster\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "1,3",
              "title": "Total number of data nodes in the cluster - $cluster",
              "type": "singlestat",
              "valueFontSize": "110%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "avg"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 8,
                "x": 16,
                "y": 6
              },
              "id": 52,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "%",
              "postfixFontSize": "80%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "max(es_cluster_shards_active_percent{job=\"$job\", cluster=\"$cluster\"})",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Active shard percent for cluster: $cluster",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "total number of shards in the cluster according to the type",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 11
              },
              "id": 4,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "max(es_cluster_shards_number{job=\"$job\", cluster=\"$cluster\"}) by (type)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": " {{type}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total number of shards in cluster ($cluster) according to type",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "columns": [],
              "fontSize": "100%",
              "gridPos": {
                "h": 9,
                "w": 16,
                "x": 0,
                "y": 18
              },
              "id": 108,
              "links": [],
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 0,
                "desc": true
              },
              "styles": [
                {
                  "alias": "Time",
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "pattern": "Time",
                  "type": "date"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "Time",
                  "thresholds": [],
                  "type": "number",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "__name__",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "cluster",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "job",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "role",
                  "thresholds": [],
                  "type": "number",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "kubernetes_namespace",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "kubernetes_pod_name",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "nodeid",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "instance",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "node",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "es_node_role_bool{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "table",
                  "instant": true,
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "A"
                }
              ],
              "title": "Role of the nodes",
              "transform": "table",
              "type": "table"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 16,
                "y": 18
              },
              "id": 86,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "max(es_cluster_is_timedout_bool{job=~\"$job\", cluster=~\"$cluster\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Is the cluster timed out?",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "No",
                  "value": "0"
                },
                {
                  "op": "=",
                  "text": "Yes",
                  "value": "1"
                }
              ],
              "valueName": "current"
            }
          ],
          "title": "Cluster related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 6
          },
          "id": 120,
          "panels": [
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 9,
                "w": 6,
                "x": 0,
                "y": 7
              },
              "id": 30,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": false,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "count(count(es_index_status{job=\"$job\", cluster=\"$cluster\"}) by (index))",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Total number of indices",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "This is the total number of documents in the node. I think this includes the replica copies as well",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 6,
                "x": 6,
                "y": 7
              },
              "id": 10,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(es_indices_doc_number{job=~\"$job\", cluster=~\"$cluster\"})",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Total documents in all indices (including replicas)",
                  "refId": "B"
                },
                {
                  "expr": "es_indices_doc_number{job=~\"$job\", cluster=~\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "node - {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_doc_number{job=~\"$job\", cluster=~\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "hide": true,
                  "instant": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total number of documents in different nodes of cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "This is the total rate of document index operation that took place. It can be higher than the documents rate in the node.  The value is summed across all nodes",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 6,
                "x": 12,
                "y": 7
              },
              "id": 34,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_indexing_index_count{job=\"$job\", cluster=\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total rate",
                  "refId": "A"
                },
                {
                  "expr": "",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Indexed operation rate for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 6,
                "x": 18,
                "y": 7
              },
              "id": 138,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "avg(deriv(es_indices_search_query_time_seconds{job=\"$job\", cluster=\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Avg time spent per node while searching queries",
                  "refId": "A"
                },
                {
                  "expr": "avg(deriv(es_indices_indexing_index_time_seconds{job=\"$job\", cluster=\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Avg time spent per node while indexing documents:",
                  "refId": "B"
                },
                {
                  "expr": "avg(deriv(es_indices_search_fetch_time_seconds{job=\"$job\", cluster=\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Avg time spent per node while search fetches",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "columns": [],
              "description": "the total number of shards including primary and replicas",
              "fontSize": "100%",
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 16
              },
              "id": 22,
              "links": [],
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 0,
                "desc": true
              },
              "styles": [
                {
                  "alias": "Time",
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "pattern": "Time",
                  "type": "date"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "cluster",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "job",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 0,
                  "mappingType": 1,
                  "pattern": "Value",
                  "thresholds": [],
                  "type": "number",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "sort(max(es_index_shards_number{job=~\"$job\", cluster=~\"$cluster\", type=\"active\"}) by (index))",
                  "format": "table",
                  "instant": true,
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "B"
                }
              ],
              "title": "Number of shards per index in cluster - $cluster",
              "transform": "table",
              "type": "table"
            },
            {
              "columns": [],
              "fontSize": "100%",
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 24
              },
              "id": 24,
              "links": [],
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 0,
                "desc": true
              },
              "styles": [
                {
                  "alias": "Time",
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "pattern": "Time",
                  "type": "date"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "cluster",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "job",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 0,
                  "mappingType": 1,
                  "pattern": "Value",
                  "thresholds": [],
                  "type": "number",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "sort(max(es_index_replicas_number{job=~\"$job\", cluster=~\"$cluster\"}) by (index))",
                  "format": "table",
                  "instant": true,
                  "intervalFactor": 1,
                  "refId": "B"
                }
              ],
              "title": "Number of replicas per index in cluster - $cluster",
              "transform": "table",
              "type": "table"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 10,
                "x": 0,
                "y": 32
              },
              "id": 62,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_indices_store_size_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Store size of the indices in bytes in nodes",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "It is the same value like the store sizes, but it shows the growth rate of the storage",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 10,
                "x": 10,
                "y": 32
              },
              "id": 148,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "deriv(es_indices_store_size_bytes{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_store_size_bytes{job=\"$job\", cluster=\"$cluster\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Growth rate store size of the indices",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "Bps",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Indices stats",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 7
          },
          "id": 130,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "The rate of search query and time spent is derived from gauge values of total search query count increase and total time increase. Sum in the expression is kind of not very useful but makes the plot look nicer and gives a summed value for the whole cluster.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 11,
                "x": 0,
                "y": 8
              },
              "id": 132,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent on search queries.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_search_query_count{job=\"$job\", cluster=\"$cluster\",node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "search query rate -- {{$node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_search_query_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent on search queries -- {{$node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of search queries and time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Search fetch and search execution are two different things. After search gets executed result need to get fetched for showing the results. Sum in the expression is kind of not very useful but makes the plot look nicer and gives a summed value for the whole cluster.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 11,
                "y": 8
              },
              "id": 136,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*rate of time spent in search .*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_search_fetch_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "rate of search fetches - {{$node}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(deriv(es_indices_search_fetch_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "rate of time spent in search fetches - {{$node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of search fetches and time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Values are derived from gauge values. Sum in the expression is kind of not very useful but makes the plot look nicer and gives a summed value for the whole cluster.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 11,
                "x": 0,
                "y": 16
              },
              "id": 134,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent in indexing .*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_indexing_index_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "document indexing rate of {{$node}}",
                  "refId": "C"
                },
                {
                  "expr": "sum(deriv(es_indices_indexing_index_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent in indexing documents of {{$node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of document indexing and time spent indexing - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "The rate of index flushes and time spent is derived from gauge values of total flush count increase and total time increase. Sum in the expression is kind of not very useful but makes the plot look nicer and gives a summed value for the whole cluster.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 11,
                "y": 16
              },
              "id": 152,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent on .*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_flush_total_count{job=\"$job\", cluster=\"$cluster\",node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "flush rate -- {{$node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_flush_total_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent on flushing-- {{$node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of index flushes and time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "delete rate and time spent in deletes",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 11,
                "x": 0,
                "y": 24
              },
              "id": 56,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent in delete.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_indexing_delete_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "delete rate -- {{$node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_indexing_delete_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent in delete -- {{$node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of documents deleted and time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "The rate of index merges and time spent is derived from gauge values of total merge count increase and total time increase. Sum in the expression is kind of not very useful but makes the plot look nicer and gives a summed value for the whole cluster.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 11,
                "y": 24
              },
              "id": 150,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent on .*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_merges_total_number{job=\"$job\", cluster=\"$cluster\",node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "merge rate -- {{$node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_merges_total_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent on merging -- {{$node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of index merges and time spent - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Please see the documentation of elasticsearch for details",
              "fill": 1,
              "gridPos": {
                "h": 10,
                "w": 11,
                "x": 0,
                "y": 32
              },
              "id": 146,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/.*time spent.*/",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(deriv(es_indices_get_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "rate of get commands: {{$node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(deriv(es_indices_suggest_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "rate of suggests: {{$node}}",
                  "refId": "C"
                },
                {
                  "expr": "sum(deriv(es_indices_search_scroll_count{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "rate of search scrolls: {{$node}}",
                  "refId": "D"
                },
                {
                  "expr": "sum(deriv(es_indices_get_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent while get commands: {{$node}}",
                  "refId": "E"
                },
                {
                  "expr": "sum(deriv(es_indices_suggest_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent while making suggests: {{$node}}",
                  "refId": "F"
                },
                {
                  "expr": "sum(deriv(es_indices_search_scroll_time_seconds{job=\"$job\", cluster=\"$cluster\", node=~\"$node\"}[5m]))",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "time spent while  search scrolls: {{$node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Other rates and time spent",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Indices performance KPIs",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 8
          },
          "id": 46,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "More information can be found:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 0,
                "y": 9
              },
              "id": 48,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_os_cpu_percent{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "os-cpu-usage percent for whole node {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_process_cpu_percent{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "process-cpu-percent for node {{node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "OS CPU percent and process CPU percent for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "percent",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 8,
                "y": 9
              },
              "id": 50,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_os_load_average_one_minute{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "one minute: {{es_node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_os_load_average_five_minutes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "five minutes:  {{es_node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_os_load_average_fifteen_minutes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "fifteen minutes:  {{es_node}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Elastisearch OS load average for the cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "More information can be found in: https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 7,
                "x": 16,
                "y": 9
              },
              "id": 96,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_os_mem_total_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "total for node: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_os_mem_free_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "free for node: {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_os_mem_used_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "used for node: {{node}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total, used and free memory for the whole node: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Further information can be found: https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 8,
                "x": 0,
                "y": 17
              },
              "id": 100,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_process_mem_total_virtual_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "memory used by ES process - node: {{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Virtual memory that is guaranteed to be available to cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "detail information can be found here:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 7,
                "x": 8,
                "y": 17
              },
              "id": 102,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_process_file_descriptors_open_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "open file descriptor: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_process_file_descriptors_max_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "File descriptor related cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Nodes stats: OS and Process information",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 9
          },
          "id": 28,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Detail information can be found: https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 11,
                "x": 0,
                "y": 10
              },
              "id": 40,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_fs_total_total_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Total size (in bytes) of all file stores: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_fs_total_available_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Actual amount of free disk space the Elasticsearch node can utilise: {{mount}}, {{type}}, {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_fs_path_total_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "File system related: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Detail information can be found: https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 11,
                "x": 11,
                "y": 10
              },
              "id": 104,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_fs_io_total_operations{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "total IO operations - node: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_fs_io_total_write_operations{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "write IO operations - node: {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_fs_io_total_read_operations{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "read IO operations - node: {{node}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "IO operation related: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Detail information can be found: https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 11,
                "x": 0,
                "y": 17
              },
              "id": 106,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_fs_io_total_write_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}} -- write volume",
                  "refId": "A"
                },
                {
                  "expr": "es_fs_io_total_read_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}} -- read volume",
                  "refId": "B"
                },
                {
                  "expr": "deriv(es_fs_io_total_read_bytes{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}} - read rate",
                  "refId": "C"
                },
                {
                  "expr": "deriv(es_fs_io_total_write_bytes{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}} - write rate",
                  "refId": "D"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "IO read write rates in bytes $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Nodes stats: FS information",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 10
          },
          "id": 142,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "fill": 0,
              "gridPos": {
                "h": 13,
                "w": 16,
                "x": 0,
                "y": 9
              },
              "id": 140,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": false,
                "min": false,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/JVM.*Heap.*/i",
                  "color": "#629e51",
                  "dashes": true,
                  "fill": 1,
                  "linewidth": 1,
                  "stack": "A"
                },
                {
                  "alias": "/Container.*/i",
                  "color": "#bf1b00",
                  "linewidth": 1
                },
                {
                  "alias": "Container Usage",
                  "linewidth": 4
                },
                {
                  "alias": "JVM Total Max",
                  "color": "#629e51"
                },
                {
                  "alias": "JVM Total Committed",
                  "color": "#3f6833"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_jvm_mem_nonheap_used_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "JVM non heap used: {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_jvm_mem_heap_used_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "JVM Heap used: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_jvm_mem_heap_committed_bytes{job=\"$job\", cluster=\"$cluster\"} + es_jvm_mem_nonheap_committed_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "JVM Total Committed: {{node}}",
                  "refId": "G"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "JVM Memory Detail View",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 13,
                "w": 8,
                "x": 16,
                "y": 9
              },
              "id": 144,
              "legend": {
                "alignAsTable": false,
                "avg": true,
                "current": true,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/gc collections.*/i",
                  "yaxis": 2
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(es_jvm_gc_collection_time_seconds{job=\"$job\", cluster=\"$cluster\"} ) by (es_node)",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "total gc collection time: {{es_node}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(es_jvm_gc_collection_count{job=\"$job\", cluster=\"$cluster\"}) by (es_node)",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "Total gc collections: {{es_node}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(es_jvm_gc_collection_time_seconds{job=\"$job\", cluster=\"$cluster\"} ) by (es_node) / sum(es_jvm_gc_collection_count{job=\"$job\", cluster=\"$cluster\"}) by (es_node)",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "refId": "C"
                },
                {
                  "expr": "sum(deriv(es_jvm_gc_collection_time_seconds{job=\"$job\", cluster=\"$cluster\"}[5m])) by (es_node)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}} - gc collection time",
                  "refId": "D"
                },
                {
                  "expr": "sum(deriv(es_jvm_gc_collection_count{job=\"$job\", cluster=\"$cluster\"}[5m])) by (es_node)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "gc collections rate: {{es_node}}",
                  "refId": "E"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "GC collections count rate and total time rate",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "JVM related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 11
          },
          "id": 114,
          "panels": [
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 0,
                "y": 12
              },
              "id": 44,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "#65c5db",
                "full": false,
                "lineColor": "#99440a",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(es_threadpool_threads_count{cluster=~\"$cluster\", job=~\"$job\", type=\"rejected\"})",
                  "format": "time_series",
                  "instant": true,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Total number of rejected thread in cluster:$cluster",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Definition of active and thread can be found here:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/cat-thread-pool.html",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 9,
                "x": 7,
                "y": 12
              },
              "id": 116,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_threadpool_threads_number{job=\"$job\", cluster=\"$cluster\", type!~\"largest\", es_node = \"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{name}}, {{type}}, {{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Threadpool: total vs active in node ($node) for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Shows the tasks that are in the queue",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 12
              },
              "id": 118,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_threadpool_tasks_number{job=\"$job\", cluster=\"$cluster\", es_node=\"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{name}}, {{type}}, {{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Number of tasks in the queue of threadpool of node ($node) for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Threadpool related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 12
          },
          "id": 110,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "Circuit breakers used to prevent operations from causing an OutOfMemoryError.",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 24,
                "x": 0,
                "y": 13
              },
              "id": 26,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": false,
                "max": true,
                "min": true,
                "rightSide": true,
                "show": true,
                "sort": null,
                "sortDesc": null,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_circuitbreaker_estimated_bytes{job=~\"$job\", cluster=\"$cluster\", es_node=\"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "estimate for {{node}} - {{name}}",
                  "refId": "A"
                },
                {
                  "expr": "es_circuitbreaker_limit_bytes{job=~\"$job\", cluster=\"$cluster\",  es_node=\"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 2,
                  "legendFormat": "limit for  {{node}} - {{name}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Circuit breaker sizes for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 2,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": false
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Details can be found: https://www.elastic.co/guide/en/elasticsearch/reference/current/circuit-breaker.html",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 20
              },
              "id": 112,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_circuitbreaker_overhead_ratio{job=\"$job\", cluster=\"$cluster\", es_node=\"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "overhead ratio {{node}} - {{name}}",
                  "refId": "A"
                },
                {
                  "expr": "es_circuitbreaker_tripped_count{job=\"$job\", cluster=\"$cluster\", es_node=\"$node\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "tripped count {{node}} - {{name}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Circuit breakers stats for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Circuit breakers",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 13
          },
          "id": 72,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 0,
                "y": 14
              },
              "id": 76,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_indices_querycache_cache_size_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "total query cache size on node: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_indices_querycache_memory_size_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "used out of total size: {{node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Query cache size in bytes",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 9,
                "x": 7,
                "y": 14
              },
              "id": 74,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_indices_querycache_miss_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "cache miss count: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_indices_querycache_hit_count{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "cache hit count: {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_indices_querycache_evictions_count{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "cache eviction count: {{node}}",
                  "refId": "C"
                },
                {
                  "expr": "es_indices_querycache_total_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "query cache usages??:{{node}}",
                  "refId": "D"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Query cache stats",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Query cache related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 14
          },
          "id": 66,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 0,
                "y": 15
              },
              "id": 68,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_indices_requestcache_memory_size_bytes{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "request cache size on node: {{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Request cache size in bytes",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 7,
                "y": 15
              },
              "id": 70,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_indices_requestcache_hit_count{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "hit count: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_indices_requestcache_miss_count{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "miss count: {{node}}",
                  "refId": "B"
                },
                {
                  "expr": "es_indices_requestcache_evictions_count{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "evictions count: {{node}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Request cache stats",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Request cache related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 15
          },
          "id": 92,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 9,
                "x": 0,
                "y": 52
              },
              "id": 94,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "logging-es-data-master-6ag6q021"
                },
                {
                  "alias": "logging-es-data-master-e04bczht"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(es_http_open_total_count{job=\"$job\", cluster=\"$cluster\"})",
                  "format": "time_series",
                  "hide": true,
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "total http connections: {{node}}",
                  "refId": "A"
                },
                {
                  "expr": "es_http_open_server_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "current open connections: {{es_node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rate of http open connection - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Http connections",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 16
          },
          "id": 78,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 0,
                "y": 7
              },
              "id": 90,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "es_transport_server_open_number{job=\"$job\", cluster=\"$cluster\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{es_node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Opened transport layer connections cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 8,
                "y": 7
              },
              "id": 58,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "deriv(es_transport_rx_bytes_count{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "bytes received: {{es_node}}",
                  "refId": "A"
                },
                {
                  "expr": "deriv(es_transport_tx_bytes_count{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "bytes sent: {{es_node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Bytes received and bytes sent rate- cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 8,
                "x": 16,
                "y": 7
              },
              "id": 82,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "deriv(es_transport_rx_packets_count{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "packets received - {{es_node}}",
                  "refId": "A"
                },
                {
                  "expr": "deriv(es_transport_tx_packets_count{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "packets sent - {{es_node}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Packets received and packets sent rate - cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Transport layer related",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 17
          },
          "id": 64,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 7,
                "x": 0,
                "y": 18
              },
              "id": 88,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(es_metrics_generate_time_seconds_sum{job=\"$job\", cluster=\"$cluster\"}[5m])/rate(es_metrics_generate_time_seconds_count{job=\"$job\", cluster=\"$cluster\"}[5m])",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{node}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Average time spent while generating metrics for cluster: $cluster",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Miscellaneous",
          "type": "row"
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "current": {
              "selected": true,
              "text": "logging-pods",
              "value": "logging-pods"
            },
            "hide": 0,
            "label": "Logging Job",
            "name": "job",
            "options": [
              {
                "selected": true,
                "text": "logging-pods",
                "value": "logging-pods"
              }
            ],
            "query": "logging-pods",
            "skipUrlSync": false,
            "type": "constant"
          },
          {
            "allValue": null,
            "current": {
              "text": "logging-es",
              "value": "logging-es"
            },
            "datasource": "DS-Prometheus",
            "definition": "label_values(es_cluster_nodes_number{job=\"$job\"}, cluster)",
            "hide": 0,
            "includeAll": false,
            "label": "Cluster",
            "multi": false,
            "name": "cluster",
            "options": [],
            "query": "label_values(es_cluster_nodes_number{job=\"$job\"}, cluster)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {
              "text": "All",
              "value": "$__all"
            },
            "datasource": "DS-Prometheus",
            "definition": "label_values(es_cluster_nodes_number{job=~\"$job\", cluster=~\"$cluster\"}, es_node)",
            "hide": 0,
            "includeAll": true,
            "label": "Node",
            "multi": false,
            "name": "node",
            "options": [],
            "query": "label_values(es_cluster_nodes_number{job=~\"$job\", cluster=~\"$cluster\"}, es_node)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Topic: OpenShift Elasticsearch",
      "uid": "acpr-elasticsearch-dashboard",
      "version": 38
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-etcd-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "Etcd Grafana cluster overview",
      "editable": true,
      "gnetId": null,
      "graphTooltip": 1,
      "id": 630756,
      "links": [],
      "panels": [
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "description": "Number of etcd cluster members in total. This should be 3 in ACPR compliant installations.",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 0,
            "y": 0
          },
          "id": 43,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(etcd_server_has_leader{job=\"etcd-cluster\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Members Total",
          "type": "singlestat",
          "valueFontSize": "200%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorPostfix": false,
          "colorValue": false,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of etcd cluster members which are currently _up_",
          "editable": true,
          "error": false,
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 3,
            "x": 3,
            "y": 0
          },
          "id": 28,
          "interval": null,
          "isNew": true,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(etcd_server_has_leader{job=\"etcd-cluster\"})",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "",
              "metric": "etcd_server_has_leader",
              "refId": "A",
              "step": 20
            }
          ],
          "thresholds": "",
          "title": "Members Up",
          "type": "singlestat",
          "valueFontSize": "200%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average gRPC operations per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 0,
          "gridPos": {
            "h": 7,
            "w": 10,
            "x": 6,
            "y": 0
          },
          "id": 23,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": " sum(rate(grpc_server_started_total{job=\"etcd-cluster\",grpc_type=\"unary\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "RPC Rate",
              "metric": "grpc_server_started_total",
              "refId": "A",
              "step": 2
            },
            {
              "expr": "sum(rate(grpc_server_handled_total{job=\"etcd-cluster\",grpc_type=\"unary\",grpc_code!=\"OK\"}[5m]))",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "RPC Failed Rate",
              "metric": "grpc_server_handled_total",
              "refId": "B",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "RPC Rate",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "ops",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of active gRPC streams (i.e. _started_ but not yet _handled_)",
          "editable": true,
          "error": false,
          "fill": 0,
          "gridPos": {
            "h": 7,
            "w": 8,
            "x": 16,
            "y": 0
          },
          "id": 41,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(grpc_server_started_total{job=\"etcd-cluster\",grpc_service=\"etcdserverpb.Watch\",grpc_type=\"bidi_stream\"}) - sum(grpc_server_handled_total{job=\"etcd-cluster\",grpc_service=\"etcdserverpb.Watch\",grpc_type=\"bidi_stream\"})",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "Watch Streams",
              "metric": "grpc_server_handled_total",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "sum(grpc_server_started_total{job=\"etcd-cluster\",grpc_service=\"etcdserverpb.Lease\",grpc_type=\"bidi_stream\"}) - sum(grpc_server_handled_total{job=\"etcd-cluster\",grpc_service=\"etcdserverpb.Lease\",grpc_type=\"bidi_stream\"})",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "Lease Streams",
              "metric": "grpc_server_handled_total",
              "refId": "B",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Active Streams",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": null,
          "description": "Space used by the _etcd_ database",
          "editable": true,
          "error": false,
          "fill": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 8,
            "x": 0,
            "y": 7
          },
          "id": 1,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "etcd_debugging_mvcc_db_total_size_in_bytes{job=\"etcd-cluster\"}",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} DB Size",
              "metric": "",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "DB Size",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "99th percentile of average WAL and DB sync duration per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 0,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 8,
            "x": 8,
            "y": 7
          },
          "id": 3,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "hideEmpty": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 1,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": true,
          "targets": [
            {
              "expr": "histogram_quantile(0.99, sum(rate(etcd_disk_wal_fsync_duration_seconds_bucket{job=\"etcd-cluster\"}[5m])) by (instance, le))",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{instance}} WAL fsync",
              "metric": "etcd_disk_wal_fsync_duration_seconds_bucket",
              "refId": "A",
              "step": 4
            },
            {
              "expr": "histogram_quantile(0.99, sum(rate(etcd_disk_backend_commit_duration_seconds_bucket{job=\"etcd-cluster\"}[5m])) by (instance, le))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} DB fsync",
              "metric": "etcd_disk_backend_commit_duration_seconds_bucket",
              "refId": "B",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Disk Sync Duration",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "s",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Resident memory the _etcd_ process is using",
          "editable": true,
          "error": false,
          "fill": 0,
          "gridPos": {
            "h": 7,
            "w": 8,
            "x": 16,
            "y": 7
          },
          "id": 29,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "process_resident_memory_bytes{job=\"etcd-cluster\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Resident Memory",
              "metric": "process_resident_memory_bytes",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Memory Used",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average traffic received from _etcd clients_ per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 5,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 0,
            "y": 14
          },
          "id": 22,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(etcd_network_client_grpc_received_bytes_total{job=\"etcd-cluster\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Client Traffic In",
              "metric": "etcd_network_client_grpc_received_bytes_total",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Client Traffic In",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average traffic sent to _etcd clients_ per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 5,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 6,
            "y": 14
          },
          "id": 21,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "rate(etcd_network_client_grpc_sent_bytes_total{job=\"etcd-cluster\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Client Traffic Out",
              "metric": "etcd_network_client_grpc_sent_bytes_total",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Client Traffic Out",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average traffic received from _etcd peers_ (i.e. other cluster members) per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 5,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 12,
            "y": 14
          },
          "id": 20,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(etcd_network_peer_received_bytes_total{job=\"etcd-cluster\"}[5m])) by (instance)",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Peer Traffic In",
              "metric": "etcd_network_peer_received_bytes_total",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Peer Traffic In",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": null,
          "description": "Average traffic sent to _etcd peers_ (i.e. other cluster members) per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 5,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 18,
            "y": 14
          },
          "id": 16,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(etcd_network_peer_sent_bytes_total{job=\"etcd-cluster\"}[5m])) by (instance)",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Peer Traffic Out",
              "metric": "etcd_network_peer_sent_bytes_total",
              "refId": "A",
              "step": 4
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Peer Traffic Out",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "cumulative"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average number of _raft_ proposals per second over 5 minutes.",
          "editable": true,
          "error": false,
          "fill": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 21
          },
          "id": 40,
          "isNew": true,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(rate(etcd_server_proposals_failed_total{job=\"etcd-cluster\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Proposal Failure Rate",
              "metric": "etcd_server_proposals_failed_total",
              "refId": "A",
              "step": 2
            },
            {
              "expr": "sum(etcd_server_proposals_pending{job=\"etcd-cluster\"})",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Proposal Pending Total",
              "metric": "etcd_server_proposals_pending",
              "refId": "B",
              "step": 2
            },
            {
              "expr": "sum(rate(etcd_server_proposals_committed_total{job=\"etcd-cluster\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Proposal Commit Rate",
              "metric": "etcd_server_proposals_committed_total",
              "refId": "C",
              "step": 2
            },
            {
              "expr": "sum(rate(etcd_server_proposals_applied_total{job=\"etcd-cluster\"}[5m]))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Proposal Apply Rate",
              "refId": "D",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Raft Proposals",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 0,
          "description": "Number of leader elections within the last 24 hours",
          "editable": true,
          "error": false,
          "fill": 0,
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 21
          },
          "id": 19,
          "isNew": true,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "changes(etcd_server_leader_changes_seen_total{job=\"etcd-cluster\"}[1d])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}} Total Leader Elections Per Day",
              "metric": "etcd_server_leader_changes_seen_total",
              "refId": "A",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Total Leader Elections Per Day",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": []
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "now": true,
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "Topic: OpenShift etcd Cluster",
      "uid": "acpr-etcd-dashboard",
      "version": 7
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-fluentd-dashboard-dashboard
data:
  dashboard.json: |
    {
      "__requires": [
        {
          "type": "grafana",
          "id": "grafana",
          "name": "Grafana",
          "version": "5.4.3"
        },
        {
          "type": "panel",
          "id": "graph",
          "name": "Graph",
          "version": "5.0.0"
        },
        {
          "type": "datasource",
          "id": "prometheus",
          "name": "Prometheus",
          "version": "5.0.0"
        },
        {
          "type": "panel",
          "id": "singlestat",
          "name": "Singlestat",
          "version": "5.0.0"
        }
      ],
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "description": "A quick dashboard for displaying Fluentd metrics.",
      "editable": true,
      "gnetId": 3522,
      "graphTooltip": 0,
      "id": null,
      "iteration": 1624977893708,
      "links": [],
      "panels": [
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": true,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "description": "Number of OpenShift Nodes where _fluentd_ is not running",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 4,
            "w": 3,
            "x": 0,
            "y": 0
          },
          "id": 9,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "count(up{job=\"logging-pods\",kubernetes_pod_name=~\"logging-fluentd-.*\"}==0)",
              "format": "time_series",
              "instant": true,
              "intervalFactor": 1,
              "refId": "A"
            }
          ],
          "thresholds": "1,1",
          "title": "Unreachable fluentd instances",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "0",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of messages emitted over the past 5 minutes",
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 4
          },
          "id": 13,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(deriv(fluentd_output_status_emit_count{kubernetes_node_name=~\"$node\"}[5m])) by (kubernetes_node_name)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{ kubernetes_node_name }}",
              "metric": "fluentd_buffer_queue_length",
              "refId": "A",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Emit count rate (5m)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Maximum length of all _fluentd_ output buffer queues over 1 minute",
          "fill": 1,
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 13
          },
          "id": 1,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(max_over_time(fluentd_output_status_buffer_queue_length{kubernetes_node_name=~\"$node\"}[1m])) by (kubernetes_node_name)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{ kubernetes_node_name }}",
              "metric": "fluentd_buffer_queue_length",
              "refId": "A",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Output buffer queue length (Max over 1m)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Maximum size of all _fluentd_ output buffer queues over 1 minute",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 22
          },
          "id": 3,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(max_over_time(fluentd_output_status_buffer_total_bytes{kubernetes_node_name=~\"$node\"}[1m])) by (kubernetes_node_name)",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ kubernetes_node_name }}",
              "metric": "fluentd_buffer_total_queued_size",
              "refId": "A",
              "step": 2
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Output buffer queued size (Max over 1m)",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "decbytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Number of fluentd output plugin retries",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 30
          },
          "id": 11,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "hideEmpty": false,
            "hideZero": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(fluentd_output_status_retry_wait{kubernetes_node_name=~\"$node\"}) by (kubernetes_node_name)",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{ kubernetes_node_name }}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Output retry wait",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Current number of errors of the _fluentd_ output plugin",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 38
          },
          "id": 12,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(fluentd_output_status_num_errors{kubernetes_node_name=~\"$node\"}) by (kubernetes_node_name)",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{ kubernetes_node_name }}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Current number of output errors",
          "tooltip": {
            "shared": true,
            "sort": 2,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "label_values(fluentd_status_buffer_total_bytes{plugin_id=\"elasticsearch-apps\"},kubernetes_node_name)",
            "hide": 0,
            "includeAll": true,
            "label": "Node",
            "multi": true,
            "name": "node",
            "options": [],
            "query": "label_values(fluentd_status_buffer_total_bytes{plugin_id=\"elasticsearch-apps\"},kubernetes_node_name)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 5,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "browser",
      "title": "Topic: OpenShift Fluentd",
      "uid": "acpr-fluentd-dashboard",
      "version": 3
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-host-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "limit": 100,
            "name": "Annotations & Alerts",
            "showIn": 0,
            "type": "dashboard"
          }
        ]
      },
      "description": "Prometheus for system metrics. \r\nLoad, CPU, RAM, network, process ... ",
      "editable": true,
      "gnetId": 6490,
      "graphTooltip": 1,
      "id": 419991,
      "iteration": 1568706095807,
      "links": [],
      "panels": [
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorPostfix": true,
          "colorValue": true,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "datasource": "DS-Prometheus",
          "decimals": 1,
          "description": "How long the system has been running.",
          "editable": true,
          "error": false,
          "format": "s",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 4,
            "x": 0,
            "y": 0
          },
          "height": "50px",
          "id": 19,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "s",
          "postfixFontSize": "80%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "calculatedInterval": "10m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_time_seconds{instance=~\"$Node\"} - node_boot_time_seconds{instance=~\"$Node\"}",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 1,
              "legendFormat": "",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_time%7Balias%3D%5C%22%24host%5C%22%7D%20-%20node_boot_time%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A25%22%2C%22step_input%22%3A%22%22%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 300
            }
          ],
          "thresholds": "300,3600",
          "title": "System Uptime",
          "transparent": false,
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of CPUs the system has",
          "editable": true,
          "error": false,
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 5,
            "x": 4,
            "y": 0
          },
          "height": "55px",
          "id": 25,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "machine_cpu_cores{kubernetes_io_hostname=~\"$Node\"}",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 1,
              "refId": "A",
              "step": 300
            }
          ],
          "thresholds": "",
          "title": "Host CPUs",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total amount of memory the system has",
          "editable": true,
          "error": false,
          "format": "decbytes",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 5,
            "x": 9,
            "y": 0
          },
          "height": "55px",
          "id": 41,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "machine_memory_bytes{kubernetes_io_hostname=~\"$Node\"}",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 1,
              "refId": "A",
              "step": 300
            }
          ],
          "thresholds": "",
          "title": "Host Memory",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "rgba(245, 54, 54, 0.9)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(50, 172, 45, 0.97)"
          ],
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Amount of Memory the systems sees as _free_  (i.e. _$total_ - _$buffers_ - _$cached_)",
          "editable": true,
          "error": false,
          "format": "decbytes",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 5,
            "x": 14,
            "y": 0
          },
          "height": "55px",
          "id": 26,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "node_memory_MemFree_bytes{instance=~\"$Node\"}",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "",
              "metric": "node_memory_MemAvailable_bytes",
              "refId": "A",
              "step": 300
            }
          ],
          "thresholds": "",
          "title": "Memory Free",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": true,
          "colors": [
            "rgba(50, 172, 45, 0.97)",
            "rgba(237, 129, 40, 0.89)",
            "rgba(245, 54, 54, 0.9)"
          ],
          "datasource": "DS-Prometheus",
          "decimals": 0,
          "description": "Percentage of the amount of memory the system sees as available (i.e. _$free_ + _$buffers_ + _$cached_)",
          "editable": true,
          "error": false,
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 5,
            "x": 19,
            "y": 0
          },
          "height": "50px",
          "id": 9,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": true,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "calculatedInterval": "10m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "((node_memory_MemFree_bytes{instance=~\"$Node\"} + node_memory_Buffers_bytes{instance=~\"$Node\"} + node_memory_Cached_bytes{instance=~\"$Node\"})) / node_memory_MemTotal_bytes{instance=~\"$Node\"} * 100",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 1,
              "legendFormat": "",
              "metric": "node_mem",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%20%2F%20node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20*%20100%22%2C%22range_input%22%3A%2243201s%22%2C%22end_input%22%3A%222015-9-15%2013%3A54%22%2C%22step_input%22%3A%22%22%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 300
            }
          ],
          "thresholds": "",
          "title": "Memory Available",
          "transparent": false,
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [],
          "valueName": "current"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "CPU Usage over the 5 minutes",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 3
          },
          "height": "260px",
          "id": 2,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "sum(irate(node_cpu_seconds_total{instance=~\"$Node\"}[5m])) by (mode) * 100 /  count(node_cpu_seconds_total{ instance=~\"$Node\"}) by (mode)",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ mode }}",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22sum(rate(node_cpu_seconds_total%7Balias%3D%5C%22%24host%5C%22%7D%5B%24interval%5D))%20by%20(mode)%20*%20100%22%2C%22range_input%22%3A%223600s%22%2C%22end_input%22%3A%222015-10-22%2015%3A27%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 20
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "CPU Usage",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percent",
              "label": "",
              "logBase": 1,
              "max": 100,
              "min": 0,
              "show": true
            },
            {
              "format": "short",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "The systems load average in total",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 10
          },
          "id": 18,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": true,
            "show": true,
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "Load 1m",
              "color": "#E24D42"
            },
            {
              "alias": "Load 5m",
              "color": "#E0752D"
            },
            {
              "alias": "Load 15m",
              "color": "#E5AC0E"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "10s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_load1{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Load 1m",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_load1%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%223601s%22%2C%22end_input%22%3A%222015-10-22%2015%3A27%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Afalse%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 20,
              "target": ""
            },
            {
              "calculatedInterval": "10s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_load5{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Load 5m",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_load5%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%223600s%22%2C%22end_input%22%3A%222015-10-22%2015%3A27%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Afalse%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 20,
              "target": ""
            },
            {
              "calculatedInterval": "10s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_load15{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Load 15m",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_load15%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%223600s%22%2C%22end_input%22%3A%222015-10-22%2015%3A27%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Afalse%2C%22tab%22%3A0%7D%5D",
              "refId": "C",
              "step": 20,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Load Average",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Memory distribution used (i.e. _$total_ - _$free_ - _$buffers_ - _$cached_) vs available (i.e. _$free_ + _$buffers_ + _$cached_)",
          "editable": true,
          "error": false,
          "fill": 6,
          "grid": {},
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 17
          },
          "height": "",
          "id": 6,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "Used",
              "color": "#0A437C"
            },
            {
              "alias": "Available",
              "color": "#5195CE"
            },
            {
              "alias": "Total",
              "color": "#052B51",
              "legend": false,
              "stack": false
            }
          ],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_MemTotal_bytes{instance=~\"$Node\"}",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "Total",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "C",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_MemTotal_bytes{instance=~\"$Node\"} - (node_memory_MemAvailable_bytes{instance=~\"$Node\"} or (node_memory_MemFree_bytes{instance=~\"$Node\"} + node_memory_Buffers_bytes{instance=~\"$Node\"} + node_memory_Cached_bytes{instance=~\"$Node\"}))",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "Used",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_MemAvailable_bytes{instance=~\"$Node\"} or (node_memory_MemFree_bytes{instance=~\"$Node\"} + node_memory_Buffers_bytes{instance=~\"$Node\"} + node_memory_Cached_bytes{instance=~\"$Node\"})",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "Available",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Memory",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "bytes",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Memory usage distribution between _$used_, _$free_, _$buffers_, and _$cached_",
          "editable": true,
          "error": false,
          "fill": 6,
          "grid": {},
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 17
          },
          "height": "",
          "id": 29,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_MemTotal_bytes{instance=~\"$Node\"} - (node_memory_MemFree_bytes{instance=~\"$Node\"} + node_memory_Buffers_bytes{instance=~\"$Node\"} + node_memory_Cached_bytes{instance=~\"$Node\"})",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Used",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_MemFree_bytes{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Free",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_Buffers_bytes{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Buffers",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "D",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_memory_Cached_bytes{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Cached",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "E",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Memory Distribution",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "bytes",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Average rate of process forks per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 26
          },
          "id": 24,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "Forks",
              "color": "#EF843C"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "rate(node_forks_total{instance=~\"$Node\"}[5m]) ",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Forks",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_procs_running%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A46%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Forks",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": true,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Number of processes in _runnable_ and _blocked_ (i.e. waiting for I/O to complete) state",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 26
          },
          "id": 20,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": false,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "Processes blocked waiting for I/O to complete",
              "color": "#E24D42"
            },
            {
              "alias": "Processes in runnable state",
              "color": "#6ED0E0"
            }
          ],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_procs_running{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Processes in runnable state",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_procs_running%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A46%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "node_procs_blocked{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Processes blocked waiting for I/O to complete",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_procs_blocked%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A46%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Processes",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Average number of kernel context switches per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 34
          },
          "id": 27,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_context_switches_total{instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Context Switches",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_procs_running%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A46%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Context Switches",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Average number of interrupts serviced per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 34
          },
          "id": 28,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "Interrupts",
              "color": "#D683CE"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2m",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_intr_total{instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Interrupts",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_procs_running%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%2243200s%22%2C%22end_input%22%3A%222015-9-18%2013%3A46%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Interrupts",
          "tooltip": {
            "msResolution": true,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "The average network traffic received (RX) and transmitted (TX) per second over 5 minutes",
          "editable": true,
          "error": false,
          "fill": 1,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 42
          },
          "id": 21,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "sort": "max",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_network_receive_bytes_total{instance=~\"$Node\", device!=\"lo\"}[5m])",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} (RX)",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 60,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_network_transmit_bytes_total{instance=~\"$Node\", device!=\"lo\"}[5m])",
              "format": "time_series",
              "interval": "5m",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} (TX)",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 60,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Network Traffic",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "bytes",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": true,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Data sent and received within one our",
          "editable": true,
          "error": false,
          "fill": 6,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 42
          },
          "id": 22,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "sort": "min",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": false,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": true,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "sum(increase(node_network_receive_bytes_total{instance=~\"$Node\", device!=\"lo\"}[1h]))",
              "format": "time_series",
              "interval": "1h",
              "intervalFactor": 1,
              "legendFormat": "Received",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 3600,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "sum(increase(node_network_transmit_bytes_total{instance=~\"$Node\", device!=\"lo\"}[1h]))",
              "format": "time_series",
              "interval": "1h",
              "intervalFactor": 1,
              "legendFormat": "Sent",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 3600,
              "target": ""
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Network Utilization Hourly",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "bytes",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Disk space used per file system in percent",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 50
          },
          "id": 40,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "(node_filesystem_size_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"} - node_filesystem_avail_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"})/ node_filesystem_size_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ mountpoint }}",
              "metric": "node_filesystem_size_bytes",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "query": "(node_filesystem_size_bytes{service_name=\"$Node\"} - node_filesystem_avail_bytes{service_name=\"$Node\"})/ node_filesystem_size_bytes{service_name=\"$Node\"}",
              "refId": "A",
              "step": 120,
              "timeField": "@timestamp"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Filesystem Usage (%)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percentunit",
              "label": null,
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Disk usage in Bytes per file system",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 50
          },
          "id": 33,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/Size.*/",
              "dashes": true,
              "fill": 0,
              "lines": true,
              "linewidth": 1,
              "stack": false
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "node_filesystem_size_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"} - node_filesystem_avail_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "Used: {{ mountpoint }}",
              "metric": "node_filesystem_size_bytes",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "query": "(node_filesystem_size_bytes{service_name=\"$Node\"} - node_filesystem_avail_bytes{service_name=\"$Node\"})/ node_filesystem_size_bytes{service_name=\"$Node\"}",
              "refId": "A",
              "step": 120,
              "timeField": "@timestamp"
            },
            {
              "expr": "node_filesystem_size_bytes{instance=~\"$Node\",device!~\"(tmpfs|selinuxfs|/dev/mapper/docker-253:.*)\",mountpoint!~\"/(run|etc)/.*\"}",
              "format": "time_series",
              "instant": false,
              "intervalFactor": 2,
              "legendFormat": "Size: {{ mountpoint }}",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Filesystem Usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Percentage of average time spent per second for disk I/O operations over 5 minutes",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 58
          },
          "id": 32,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "sideWidth": 240,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_disk_io_time_seconds_total {instance=~'$Node',device!~'^(md\\\\d+$|dm-|sr0)'}[5m]) * 100",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }}",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "query": "irate(node_disk_io_time_seconds_total {instance='$instance',device!~'^(md\\\\d+$|dm-)'}[5m]) / 1000",
              "refId": "A",
              "step": 120,
              "timeField": "@timestamp"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Disk I/O Utilisation",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": "100",
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of disk I/O operations per second (iops) currently in progress",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 58
          },
          "id": 34,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.* io time/",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "node_disk_io_now{instance=~\"$Node\",device!~\"sr0\"}",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{ device }}",
              "metric": "node_disk_io_now",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "A",
              "step": 120,
              "timeField": "@timestamp"
            },
            {
              "expr": "irate(node_disk_io_time_seconds_total {instance=~\"$Node\",device!~\"sr0\"}[1m])",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{ device }} io time",
              "metric": "node_disk_io_time_seconds_total ",
              "refId": "B",
              "step": 120
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Disk I/O",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": [
              "total"
            ]
          },
          "yaxes": [
            {
              "format": "iops",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "ms",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average per second disk throughput (r/w) over 5 minutes",
          "fill": 1,
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 66
          },
          "id": 35,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.* written/",
              "transform": "negative-Y"
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_disk_read_bytes_total{instance=~\"$Node\",device!~\"sr0\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} read",
              "metric": "node_disk_bytes",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "A",
              "step": 120,
              "timeField": "@timestamp"
            },
            {
              "expr": "irate(node_disk_write_time_seconds_total{instance=~\"$Node\",device!~\"sr0\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} write",
              "metric": "node_disk_write_time_seconds_total ",
              "refId": "B",
              "step": 120
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Disk throughput",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "Bps",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Per second rate of pages stored to (pgpgout) and read (pgpgin) as well as page faults",
          "editable": true,
          "error": false,
          "fill": 2,
          "grid": {},
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 66
          },
          "id": 31,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "hideEmpty": false,
            "max": true,
            "min": true,
            "rightSide": false,
            "show": true,
            "sideWidth": null,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*[pP]age faults/",
              "fill": 0,
              "linewidth": 1,
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_vmstat_pgpgin{instance=~\"$Node\"}[5m]) * 1024",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Page In",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemTotal_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20-%20(node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D)%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "A",
              "step": 20,
              "target": ""
            },
            {
              "calculatedInterval": "2s",
              "datasourceErrors": {},
              "errors": {},
              "expr": "irate(node_vmstat_pgpgout{instance=~\"$Node\"}[5m]) * 1024",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "Page Out",
              "metric": "",
              "prometheusLink": "/api/datasources/proxy/1/graph#%5B%7B%22expr%22%3A%22node_memory_MemFree_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Buffers_bytes%7Balias%3D%5C%22%24host%5C%22%7D%20%2B%20node_memory_Cached_bytes%7Balias%3D%5C%22%24host%5C%22%7D%22%2C%22range_input%22%3A%22900s%22%2C%22end_input%22%3A%222015-10-22%2015%3A25%22%2C%22step_input%22%3A%22%22%2C%22stacked%22%3Atrue%2C%22tab%22%3A0%7D%5D",
              "refId": "B",
              "step": 20,
              "target": ""
            },
            {
              "expr": "irate(node_vmstat_pgfault{instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "Page faults",
              "refId": "C"
            },
            {
              "expr": "irate(node_vmstat_pgmajfault{instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "Major page faults",
              "refId": "D"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Memory Management (Paging)",
          "tooltip": {
            "msResolution": false,
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": "PAGING",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            },
            {
              "format": "none",
              "label": "PAGE FAULTS",
              "logBase": 1,
              "max": null,
              "min": 0,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average per second drops and errors (_RX_ and _TX_) per NIC over 5 minutes",
          "fill": 2,
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 74
          },
          "id": 36,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*error/",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_network_receive_drop_total {instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }}  drops (RX)",
              "metric": "node_network_receive_drop_total ",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "A",
              "step": 40,
              "timeField": "@timestamp"
            },
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_network_transmit_drop_total {instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} drops (TX)",
              "metric": "node_network_transmit_drop_total ",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "B",
              "step": 40,
              "timeField": "@timestamp"
            },
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_network_receive_errs_total {instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} errors (RX)",
              "metric": "node_network_receive_errs_total ",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "C",
              "step": 40,
              "timeField": "@timestamp"
            },
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "irate(node_network_transmit_errs_total {instance=~\"$Node\"}[5m])",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ device }} errors (TX)",
              "metric": "node_network_transmit_errs_total ",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "D",
              "step": 40,
              "timeField": "@timestamp"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Network interface card (NIC) stats",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": [
              "total"
            ]
          },
          "yaxes": [
            {
              "format": "none",
              "label": "NET DROP",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "none",
              "label": "NET ERROR",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of TCP connections in state _established_",
          "fill": 2,
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 83
          },
          "id": 38,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": true,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "connected",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*error/",
              "yaxis": 2
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "bucketAggs": [
                {
                  "field": "@timestamp",
                  "id": "2",
                  "settings": {
                    "interval": "auto",
                    "min_doc_count": 0,
                    "trimEdges": 0
                  },
                  "type": "date_histogram"
                }
              ],
              "dsType": "elasticsearch",
              "expr": "node_netstat_Tcp_CurrEstab{instance=~\"$Node\"}",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "TCP connections (established)",
              "metric": "node_network_receive_drop_total ",
              "metrics": [
                {
                  "field": "select field",
                  "id": "1",
                  "type": "count"
                }
              ],
              "refId": "A",
              "step": 40,
              "timeField": "@timestamp"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "TCP connection stats",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": [
              "total"
            ]
          },
          "yaxes": [
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "none",
              "label": "",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "label_values(kube_node_labels,node)",
            "hide": 0,
            "includeAll": false,
            "label": "Node",
            "multi": true,
            "name": "Node",
            "options": [],
            "query": "label_values(kube_node_labels,node)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "collapse": false,
        "enable": true,
        "notice": false,
        "now": true,
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "status": "Stable",
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ],
        "type": "timepicker"
      },
      "timezone": "",
      "title": "Topic: Host",
      "uid": "acpr-host-dashboard",
      "version": 5
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-nfsd-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 1,
      "id": 634520,
      "iteration": 1569417569206,
      "links": [],
      "panels": [
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Average data read/ written per second by the _NFS_ daemon",
          "fill": 3,
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 6,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_disk_bytes_read_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Read",
              "refId": "A"
            },
            {
              "expr": "irate(node_nfsd_disk_bytes_written_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "interval": "2m",
              "intervalFactor": 1,
              "legendFormat": "Written",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Data troughput",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "Bps",
              "label": "Bytes read (-) / write (+)",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "Hits": "#890f02"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Average NFS reply cache operations per second over 5 minutes",
          "fill": 3,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 9
          },
          "id": 2,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_reply_cache_hits_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Hits",
              "refId": "A"
            },
            {
              "expr": "irate(node_nfsd_reply_cache_misses_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Misses",
              "refId": "B"
            },
            {
              "expr": "irate(node_nfsd_reply_cache_nocache_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Nocache",
              "refId": "C"
            },
            {
              "expr": "irate(node_nfsd_read_ahead_cache_not_found_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Not found",
              "refId": "D"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Reply Cache",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of stale file handles within the last 5 minutes",
          "fill": 3,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 9
          },
          "id": 4,
          "legend": {
            "alignAsTable": true,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "idelta(node_nfsd_file_handles_stale_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "1m",
              "intervalFactor": 2,
              "legendFormat": "Stale file handles",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Stale File Handles",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "Not found": "#e5ac0e",
            "Size": "#65c5db"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "decimals": null,
          "description": "Average number of entries not found in cache  per second over 5 minutes",
          "fill": 3,
          "gridPos": {
            "h": 10,
            "w": 12,
            "x": 0,
            "y": 18
          },
          "id": 10,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_read_ahead_cache_not_found_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "instant": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "Not found",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Read Ahead Cache rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "Auth": "#508642",
            "CInt": "#bf1b00",
            "Fmt": "#c15c17"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Average number of RPC calls and errors per second over 5 minutes",
          "fill": 3,
          "gridPos": {
            "h": 10,
            "w": 12,
            "x": 12,
            "y": 18
          },
          "id": 14,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_rpc_errors_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "1m",
              "intervalFactor": 2,
              "legendFormat": "Error - {{ error }}",
              "refId": "A"
            },
            {
              "expr": "irate(node_nfsd_server_rpcs_total{instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "1m",
              "intervalFactor": 2,
              "legendFormat": "Total",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "RPC rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter errors (-) / success (+)",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "Threads": "#d683ce"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "decimals": 0,
          "description": "Number of NFSd kernel threads that are running",
          "fill": 3,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 28
          },
          "id": 8,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "node_nfsd_server_threads{instance=~\"$nfs_host\"}",
              "format": "time_series",
              "interval": "2m",
              "intervalFactor": 2,
              "legendFormat": "Threads",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Threads",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {
            "TCP": "#614d93",
            "UDP": "#e24d42"
          },
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Average number of TCP and UDP packets per second over 5 minutes",
          "fill": 3,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 28
          },
          "id": 12,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_packets_total{instance=~\"$nfs_host\", proto=\"tcp\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "1m",
              "intervalFactor": 2,
              "legendFormat": "TCP",
              "refId": "A"
            },
            {
              "expr": "irate(node_nfsd_packets_total{instance=~\"$nfs_host\", proto=\"udp\"}[5m])",
              "format": "time_series",
              "hide": false,
              "interval": "1m",
              "intervalFactor": 2,
              "legendFormat": "UDP",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Network Packets rate",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "pps",
              "label": "Packets",
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Average number of NFSv3 requests per second over 5 minutes",
          "fill": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 0,
            "y": 37
          },
          "id": 16,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_requests_total{proto=\"3\", instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ method }}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests by method (Proc3)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "description": "Average number of NFSv4 requests per second over 5 minutes",
          "fill": 0,
          "gridPos": {
            "h": 9,
            "w": 12,
            "x": 12,
            "y": 37
          },
          "id": 17,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": false,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "irate(node_nfsd_requests_total{proto=\"4\", instance=~\"$nfs_host\"}[5m])",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{ method }}",
              "refId": "A"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requests by method (Proc4)",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": "Counter",
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": false
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "label_values(node_boot_time_seconds, instance)",
            "hide": 0,
            "includeAll": false,
            "label": "Node",
            "multi": true,
            "name": "nfs_host",
            "options": [],
            "query": "label_values(node_boot_time_seconds, instance)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Topic: NFS Server",
      "uid": "acpr-nfsd-dashboard",
      "version": 3
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-node-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "DS-Prometheus",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": 446246,
      "iteration": 1569333324484,
      "links": [],
      "panels": [
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Number of CPUs the system has",
          "format": "none",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 8,
            "x": 0,
            "y": 0
          },
          "id": 100,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(machine_cpu_cores{instance=~\"^$Node\"})",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Node CPUs",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Total amount of memory the system has",
          "format": "bytes",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 8,
            "x": 8,
            "y": 0
          },
          "id": 101,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "machine_memory_bytes{instance=~\"^$Node\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Node Memory",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "decimals": 1,
          "description": "How long the system has been running",
          "format": "s",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 3,
            "w": 8,
            "x": 16,
            "y": 0
          },
          "id": 102,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "s",
          "postfixFontSize": "80%",
          "prefix": "",
          "prefixFontSize": "80%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": false
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "node_time_seconds{instance=~\"$Node\"} - node_boot_time_seconds{instance=~\"$Node\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "System Uptime",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "CPU usage of the node (i.e. not _idle_ )",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 5,
            "w": 8,
            "x": 0,
            "y": 3
          },
          "id": 87,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "(sum(node_cpu_seconds_total{instance=~\"^$Node\", mode!=\"idle\"}) / sum(node_cpu_seconds_total{instance=~\"^$Node\"}) ) * 100",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "",
              "refId": "B"
            }
          ],
          "thresholds": "65, 90",
          "title": "Node CPU Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Memory usage of the node (i.e. _$used_ + _$buffers_ + _$cached_",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 5,
            "w": 8,
            "x": 8,
            "y": 3
          },
          "id": 80,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "(sum(node_memory_MemTotal_bytes{instance=~\"^$Node\"}) - sum(node_memory_MemFree_bytes{instance=~\"^$Node\"}+node_memory_Buffers_bytes{instance=~\"^$Node\"}+node_memory_Cached_bytes{instance=~\"^$Node\"}) ) / sum(node_memory_MemTotal_bytes{instance=~\"^$Node\"}) * 100",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "65, 90",
          "title": "Node Memory Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Disk usage of the nodes' root file system (/)",
          "format": "percent",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": true,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 5,
            "w": 8,
            "x": 16,
            "y": 3
          },
          "id": 89,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "100 - 100* (sum (node_filesystem_avail_bytes{instance=~\"^$Node\", mountpoint=\"/etc/hostname\"}) / sum(node_filesystem_size_bytes{instance=~\"^$Node\", mountpoint=\"/etc/hostname\"}))",
              "format": "time_series",
              "intervalFactor": 2,
              "refId": "A"
            }
          ],
          "thresholds": "50,80",
          "title": "Node Root FS Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "N/A",
              "value": "null"
            }
          ],
          "valueName": "current"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "CPU usage of the node (i.e. not _idle_ )",
          "fill": 1,
          "gridPos": {
            "h": 6,
            "w": 8,
            "x": 0,
            "y": 8
          },
          "id": 104,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(node_cpu_seconds_total{instance=~\"^$Node\", mode!=\"idle\"}) by (instance)/ sum(node_cpu_seconds_total{instance=~\"^$Node\"}) by (instance)",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }}",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node CPU Usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "percentunit",
              "label": null,
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Memory usage of the node (i.e. _$used_ + _$buffers_ + _$cached_",
          "fill": 1,
          "gridPos": {
            "h": 6,
            "w": 8,
            "x": 8,
            "y": 8
          },
          "hideTimeOverride": false,
          "id": 79,
          "legend": {
            "alignAsTable": false,
            "avg": false,
            "current": false,
            "hideEmpty": false,
            "hideZero": false,
            "max": false,
            "min": false,
            "rightSide": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(node_memory_MemTotal_bytes{instance=~\"^$Node\"} - node_memory_MemFree_bytes{instance=~\"^$Node\"} - node_memory_Buffers_bytes{instance=~\"^$Node\"} - node_memory_Cached_bytes{instance=~\"^$Node\"}) by (instance) / sum(node_memory_MemTotal_bytes{instance=~\"^$Node\"}) by (instance)",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "{{ instance }}",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node Memory Usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "transparent": false,
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "percentunit",
              "label": null,
              "logBase": 1,
              "max": "1",
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Disk usage of the nodes' root file system (/)",
          "fill": 1,
          "gridPos": {
            "h": 6,
            "w": 8,
            "x": 16,
            "y": 8
          },
          "id": 90,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "100 - 100 * (sum (node_filesystem_avail_bytes{instance=~\"^$Node\", mountpoint=\"/etc/hostname\"})  by (instance) / sum(node_filesystem_size_bytes{instance=~\"^$Node\", mountpoint=\"/etc/hostname\"})  by (instance))",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }}",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node Root FS Usage",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "decimals": null,
              "format": "percent",
              "label": null,
              "logBase": 1,
              "max": "100",
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "The systems load average in total",
          "fill": 1,
          "gridPos": {
            "h": 6,
            "w": 24,
            "x": 0,
            "y": 14
          },
          "id": 88,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": false,
            "max": true,
            "min": true,
            "rightSide": true,
            "show": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "node_load1{instance=~\"^$Node\"}",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }} (1m)",
              "refId": "A"
            },
            {
              "expr": "node_load5{instance=~\"^$Node\"}",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }}  (5m)",
              "refId": "B"
            },
            {
              "expr": "node_load15{instance=~\"^$Node\"}",
              "format": "time_series",
              "hide": false,
              "instant": false,
              "interval": "",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }} (15m)",
              "refId": "C"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Node Load Average",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "none",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "CPU cores requested by all pods running on the node",
          "fill": 1,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 0,
            "y": 20
          },
          "id": 92,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*host cpu\\)$/",
              "dashes": true,
              "fill": 0,
              "linewidth": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests_cpu_cores{node=~\"^$Node\",container!~\".*job.*\"}) by (node)",
              "format": "time_series",
              "hide": false,
              "interval": "",
              "intervalFactor": 2,
              "legendFormat": "{{node}} (requested)",
              "refId": "A"
            },
            {
              "expr": "machine_cpu_cores{instance=~\"^$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }} (host cpu)",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requested CPU Cores",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Memory requested by all pods running on the node",
          "fill": 1,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 6,
            "y": 20
          },
          "id": 93,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*host memory\\)$/",
              "dashes": true,
              "fill": 0,
              "linewidth": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "sum(kube_pod_container_resource_requests_memory_bytes{node=~\"^$Node\"}) by (node)  ",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "{{node}} (requested)",
              "refId": "A"
            },
            {
              "expr": "machine_memory_bytes{instance=~\"^$Node\"}",
              "format": "time_series",
              "intervalFactor": 1,
              "legendFormat": "{{ instance }} (host memory)",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Requested Memory",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "bytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": "0",
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "description": "Number of pods in running state in comparison to maximum number of Pods per node",
          "fill": 1,
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 12,
            "y": 20
          },
          "id": 91,
          "legend": {
            "avg": false,
            "current": false,
            "max": false,
            "min": false,
            "show": true,
            "total": false,
            "values": false
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [
            {
              "alias": "/.*pod limit\\)$/",
              "dashes": true,
              "fill": 0,
              "linewidth": 1
            }
          ],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": false,
          "targets": [
            {
              "expr": "kubelet_running_pod_count{instance=~\"^$Node\"}",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{instance}}",
              "refId": "A"
            },
            {
              "expr": "kube_node_status_capacity_pods{node=~\"^$Node\"}",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 1,
              "legendFormat": "{{ node }} (pod limit)",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Pods per Node",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        },
        {
          "cacheTimeout": null,
          "colorBackground": false,
          "colorValue": false,
          "colors": [
            "#299c46",
            "rgba(237, 129, 40, 0.89)",
            "#d44a3a"
          ],
          "datasource": "DS-Prometheus",
          "description": "Memory Usage of containers provided by Avaloq. _0_ is shown if no Avaloq provided Application is running on the node",
          "format": "decbytes",
          "gauge": {
            "maxValue": 100,
            "minValue": 0,
            "show": false,
            "thresholdLabels": false,
            "thresholdMarkers": true
          },
          "gridPos": {
            "h": 7,
            "w": 6,
            "x": 18,
            "y": 20
          },
          "id": 103,
          "interval": null,
          "links": [],
          "mappingType": 1,
          "mappingTypes": [
            {
              "name": "value to text",
              "value": 1
            },
            {
              "name": "range to text",
              "value": 2
            }
          ],
          "maxDataPoints": 100,
          "nullPointMode": "connected",
          "nullText": null,
          "postfix": "",
          "postfixFontSize": "50%",
          "prefix": "",
          "prefixFontSize": "50%",
          "rangeMaps": [
            {
              "from": "null",
              "text": "N/A",
              "to": "null"
            }
          ],
          "sparkline": {
            "fillColor": "rgba(31, 118, 189, 0.18)",
            "full": false,
            "lineColor": "rgb(31, 120, 193)",
            "show": true
          },
          "tableColumn": "",
          "targets": [
            {
              "expr": "sum(container_memory_usage_bytes{image!=\"\", instance=~\"^$Node\", container_name=~\"avaloq-.*\"})/count(container_memory_usage_bytes{image!=\"\", instance=~\"^$Node\", container_name=~\"avaloq-.*\"})",
              "format": "time_series",
              "hide": false,
              "intervalFactor": 2,
              "legendFormat": "",
              "refId": "A"
            }
          ],
          "thresholds": "",
          "title": "Avaloq Container Memory Usage",
          "type": "singlestat",
          "valueFontSize": "80%",
          "valueMaps": [
            {
              "op": "=",
              "text": "0",
              "value": "null"
            }
          ],
          "valueName": "avg"
        },
        {
          "aliasColors": {},
          "bars": false,
          "dashLength": 10,
          "dashes": false,
          "datasource": "DS-Prometheus",
          "decimals": 2,
          "description": "Top 10 pods in regards of memory consumption",
          "fill": 1,
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 27
          },
          "id": 99,
          "legend": {
            "alignAsTable": true,
            "avg": true,
            "current": true,
            "hideEmpty": false,
            "hideZero": false,
            "max": true,
            "min": false,
            "rightSide": true,
            "show": true,
            "sort": "max",
            "sortDesc": true,
            "total": false,
            "values": true
          },
          "lines": true,
          "linewidth": 2,
          "links": [],
          "nullPointMode": "null",
          "percentage": false,
          "pointradius": 5,
          "points": false,
          "renderer": "flot",
          "seriesOverrides": [],
          "spaceLength": 10,
          "stack": false,
          "steppedLine": true,
          "targets": [
            {
              "expr": "sort_desc(topk(10,sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",container_name!=\"POD\",kubernetes_io_hostname=~\"^$Node$\"}) by (pod_name, name, image,kubernetes_io_hostname)))",
              "format": "time_series",
              "intervalFactor": 2,
              "legendFormat": "{{ pod_name}} on {{ kubernetes_io_hostname }} ({{ image }})",
              "refId": "B"
            }
          ],
          "thresholds": [],
          "timeFrom": null,
          "timeRegions": [],
          "timeShift": null,
          "title": "Top memory consumer",
          "tooltip": {
            "shared": true,
            "sort": 0,
            "value_type": "individual"
          },
          "type": "graph",
          "xaxis": {
            "buckets": null,
            "mode": "time",
            "name": null,
            "show": true,
            "values": []
          },
          "yaxes": [
            {
              "format": "decbytes",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            },
            {
              "format": "short",
              "label": null,
              "logBase": 1,
              "max": null,
              "min": null,
              "show": true
            }
          ],
          "yaxis": {
            "align": false,
            "alignLevel": null
          }
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {
              "text": "All",
              "value": "$__all"
            },
            "datasource": "DS-Prometheus",
            "definition": "label_values(kube_node_labels,node)",
            "hide": 0,
            "includeAll": false,
            "label": "Node",
            "multi": true,
            "name": "Node",
            "options": [],
            "query": "label_values(kube_node_labels,node)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-3h",
        "to": "now"
      },
      "timepicker": {
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Topic: OpenShift Node",
      "uid": "acpr-node-dashboard",
      "version": 11
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    acpr.avaloq.com/kind: grafana-dashboards
    dashboard-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: acpr-project-dashboard-dashboard
data:
  dashboard.json: |
    {
      "annotations": {
        "list": [
          {
            "builtIn": 1,
            "datasource": "-- Grafana --",
            "enable": true,
            "hide": true,
            "iconColor": "rgba(0, 211, 255, 1)",
            "name": "Annotations & Alerts",
            "type": "dashboard"
          }
        ]
      },
      "editable": true,
      "gnetId": null,
      "graphTooltip": 0,
      "id": 2734,
      "iteration": 1570193407191,
      "links": [],
      "panels": [
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 0
          },
          "id": 55,
          "panels": [
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "datasource": "DS-Prometheus",
              "description": "It includes all pods that belong to this project constellation, including those that did not pass the readiness check",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 5,
                "x": 0,
                "y": 1
              },
              "id": 57,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "count(kube_pod_info{namespace=~\"$namespace\", created_by_kind!=\"Job\"} * on(pod) kube_pod_status_ready{condition=\"true\", namespace=~\"$namespace\"})",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Total number of pods in $namespace",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "description": "It contains the total number of pods that pass the readiness check. If there are differences between total pods and this number then some pods are not ready.",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 5,
                "x": 5,
                "y": 1
              },
              "id": 59,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "count (kube_pod_info{namespace=~\"$namespace\", created_by_kind!=\"Job\"} * on(pod) kube_pod_status_ready{condition=\"true\", namespace=~\"$namespace\"}==1)",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Total pods that passes readiness check",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#d44a3a"
              ],
              "description": "Total count of pods that are being scrapped successfully by prometheus",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 5,
                "x": 10,
                "y": 1
              },
              "id": 61,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "rgba(31, 118, 189, 0.18)",
                "full": true,
                "lineColor": "#c15c17",
                "show": true
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "count(up{kubernetes_namespace=~\"^$namespace\"} == 1)",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "",
              "title": "Total pods being scrapped successfully by Prometheus",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                }
              ],
              "valueName": "current"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#99440a"
              ],
              "description": "Some pods in the project logging error or warning messages. Please check the logs.",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 5,
                "x": 15,
                "y": 1
              },
              "id": 65,
              "interval": null,
              "links": [],
              "mappingType": 2,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "0",
                  "text": "None",
                  "to": "0"
                },
                {
                  "from": "0.00001",
                  "text": "Yes",
                  "to": "100000"
                },
                {
                  "from": "null",
                  "text": "N/A",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "#5195ce",
                "full": false,
                "lineColor": "#629e51",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(rate(log4j2_events_total{kubernetes_namespace=~\"$namespace\", level!=\"info\"}[5m])) ",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "0.000001,1",
              "title": "Logging error or warning exists?",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                },
                {
                  "op": "=",
                  "text": "",
                  "value": ""
                }
              ],
              "valueName": "range"
            },
            {
              "cacheTimeout": null,
              "colorBackground": false,
              "colorValue": false,
              "colors": [
                "#299c46",
                "rgba(237, 129, 40, 0.89)",
                "#99440a"
              ],
              "description": "Some pods in the project are giving rest error responses. Please check the details.",
              "format": "ops",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 5,
                "w": 4,
                "x": 20,
                "y": 1
              },
              "id": 67,
              "interval": null,
              "links": [],
              "mappingType": 2,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "",
              "prefixFontSize": "50%",
              "rangeMaps": [
                {
                  "from": "0",
                  "text": "No",
                  "to": "0"
                },
                {
                  "from": "1",
                  "text": "Yes",
                  "to": "100000"
                },
                {
                  "from": "null",
                  "text": "No",
                  "to": "null"
                }
              ],
              "sparkline": {
                "fillColor": "#5195ce",
                "full": false,
                "lineColor": "#629e51",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "sum(rate(http_server_requests_seconds_count{kubernetes_namespace=~\"$namespace\", status!~\"2..\"}[$__interval]))",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "1",
              "title": "Rest error calls exists?",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                },
                {
                  "op": "=",
                  "text": "",
                  "value": ""
                }
              ],
              "valueName": "range"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Compares the CPU Usage to CPU request and limit. Ideally, in a development environment, your usage should be close to the request.",
              "fill": 1,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 0,
                "y": 6
              },
              "id": 71,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/request.*/",
                  "fill": 0,
                  "linewidth": 2,
                  "yaxis": 1
                },
                {
                  "alias": "/limit.*/",
                  "fill": 0,
                  "linewidth": 2,
                  "yaxis": 1
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(irate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\"}[5m]) * 1000)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Total CPU usage",
                  "refId": "A"
                },
                {
                  "expr": "sum(kube_pod_container_resource_requests_cpu_cores{namespace=\"$namespace\"} * 1000) ",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Total CPU request",
                  "refId": "B"
                },
                {
                  "expr": "sum(kube_pod_container_resource_limits_cpu_cores{namespace=\"$namespace\"} * 1000) ",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Total CPU limit",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total CPU usage vs CPU request and limit in $namespace",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "millicores",
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": "",
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": false
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "It compares the total memory usage vs total memory request for the project over a period of time",
              "fill": 0,
              "gridPos": {
                "h": 9,
                "w": 12,
                "x": 12,
                "y": 6
              },
              "id": 73,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/JVM.*Heap.*/i",
                  "color": "#629e51",
                  "dashes": true,
                  "fill": 1,
                  "linewidth": 1,
                  "stack": "A"
                },
                {
                  "alias": "/Container.*/i",
                  "color": "#bf1b00",
                  "linewidth": 1
                },
                {
                  "alias": "Container Usage",
                  "linewidth": 4
                },
                {
                  "alias": "JVM Total Max",
                  "color": "#629e51"
                },
                {
                  "alias": "JVM Total Committed",
                  "color": "#3f6833"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(container_memory_usage_bytes{namespace=\"$namespace\", container_name=\"\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total Project Memory Usage ",
                  "refId": "I"
                },
                {
                  "expr": "sum(kube_pod_container_resource_requests_memory_bytes{namespace=\"$namespace\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total Project Memory Request",
                  "refId": "E"
                },
                {
                  "expr": "sum(kube_pod_container_resource_limits_memory_bytes{namespace=\"$namespace\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total Project Memory Limit",
                  "refId": "D"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Total Project Memory Usage vs Memory Request and Limit",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Project Overview",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 1
          },
          "id": 69,
          "panels": [
            {
              "columns": [],
              "description": "If pods are not up for scrapping, then detail measurements will not be available in the dashboard",
              "fontSize": "90%",
              "gridPos": {
                "h": 7,
                "w": 9,
                "x": 0,
                "y": 2
              },
              "id": 75,
              "links": [],
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 0,
                "desc": true
              },
              "styles": [
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "pattern": "Time",
                  "thresholds": [],
                  "type": "date",
                  "unit": "short"
                },
                {
                  "alias": "target",
                  "colorMode": "cell",
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 0,
                  "mappingType": 1,
                  "pattern": "Value",
                  "sanitize": false,
                  "thresholds": [
                    "0.4",
                    "0.6"
                  ],
                  "type": "string",
                  "unit": "short",
                  "valueMaps": [
                    {
                      "text": "up",
                      "value": "1"
                    },
                    {
                      "text": "down",
                      "value": "0"
                    }
                  ]
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "__name__",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "instance",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "job",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "kubernetes_namespace",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "up{kubernetes_namespace=~\"^$namespace\", app=~\"$app\"}",
                  "format": "table",
                  "instant": true,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "title": "Pods being available in prometheus target list for $app",
              "transform": "table",
              "type": "table"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Please note that this is only available for the pods that are up for scrapping from Prometheus perspective",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 7,
                "x": 9,
                "y": 2
              },
              "id": 79,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(http_server_requests_seconds_max{kubernetes_namespace=~\"^$namespace\", app=~\"$app\"}[5m]) ",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{app}} {{uri}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Response Time for the pods in $app",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Please note this is available only for the pods that are 'up' for scrapping from Prometheus perspective",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 8,
                "x": 16,
                "y": 2
              },
              "id": 77,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(http_server_requests_seconds_count{kubernetes_namespace=~\"^$namespace\", app=~\"$app\"}[5m])",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{app}} {{uri}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(http_server_requests_seconds_count{kubernetes_namespace=~\"^$namespace\", app=~\"$app\"}[5m]))",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "total number of requests",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Request Rate for the pods in $app",
              "tooltip": {
                "shared": false,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Application Overview",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 2
          },
          "id": 81,
          "panels": [
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Compares the CPU Usage to CPU request and limit for pod. Ideally, in a development environment, your usage should be close to the request.",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 3
              },
              "id": 53,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/request.*/",
                  "fill": 0,
                  "linewidth": 2,
                  "yaxis": 1
                },
                {
                  "alias": "/limit.*/",
                  "fill": 0,
                  "linewidth": 2,
                  "yaxis": 1
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(irate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\", pod_name=~\"$pod\"}[5m]) * 1000) by (pod_name)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "usage- {{pod_name}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(kube_pod_container_resource_requests_cpu_cores{namespace=\"$namespace\", pod=~\"$pod\"}*1000) by (pod)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "request-{{pod}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(kube_pod_container_resource_limits_cpu_cores{namespace=\"$namespace\", pod=~\"$pod\"}*1000) by (pod)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "limit-{{pod}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "CPU usage vs CPU request and limit for POD-  $pod",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "millicores",
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": "",
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": false
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "Compares the total memory usage of a pod with memory request and limit",
              "fill": 0,
              "gridPos": {
                "h": 13,
                "w": 12,
                "x": 12,
                "y": 3
              },
              "id": 83,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/JVM.*Heap.*/i",
                  "color": "#629e51",
                  "dashes": true,
                  "fill": 1,
                  "linewidth": 1,
                  "stack": "A"
                },
                {
                  "alias": "/Container.*/i",
                  "color": "#bf1b00",
                  "linewidth": 1
                },
                {
                  "alias": "Container Usage",
                  "linewidth": 4
                },
                {
                  "alias": "JVM Total Max",
                  "color": "#629e51"
                },
                {
                  "alias": "JVM Total Committed",
                  "color": "#3f6833"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "max(container_memory_usage_bytes{namespace=\"$namespace\", pod_name=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "usage-$pod",
                  "refId": "I"
                },
                {
                  "expr": "sum(kube_pod_container_resource_requests_memory_bytes{namespace=\"$namespace\", pod=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "request-$pod",
                  "refId": "E"
                },
                {
                  "expr": "sum(kube_pod_container_resource_limits_memory_bytes{namespace=\"$namespace\", pod=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "limit-$pod",
                  "refId": "D"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Memory usage vs limit and request for POD - $pod",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "A breakdown of total CPU time in user time and system time",
              "fill": 1,
              "gridPos": {
                "h": 5,
                "w": 12,
                "x": 0,
                "y": 11
              },
              "id": 91,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(container_cpu_usage_seconds_total{namespace=~\"$namespace\", image!=\"\", pod_name=~\"$pod\"}[5m]) * 1000) by (pod_name)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total - {{pod_name}}",
                  "refId": "A"
                },
                {
                  "expr": "sum(rate(container_cpu_user_seconds_total{namespace=~\"$namespace\", image!=\"\", pod_name=~\"$pod\"}[5m]) * 1000) by (pod_name)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "User - {{pod_name}}",
                  "refId": "B"
                },
                {
                  "expr": "sum(rate(container_cpu_system_seconds_total {namespace=~\"$namespace\", image!=\"\", pod_name=~\"$pod\"}[5m]) * 1000) by (pod_name)",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "System - {{pod_name}}",
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "CPU Usage breakdown",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": "millicores",
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "cacheTimeout": null,
              "colorBackground": true,
              "colorValue": false,
              "colors": [
                "#99440a",
                "rgba(237, 129, 40, 0.89)",
                "#299c46"
              ],
              "description": "Tells whether the pod is scrappable by Prometheus. If it is not scrapable only minimum information is available about the pod through the Kubernetes environment.",
              "format": "none",
              "gauge": {
                "maxValue": 100,
                "minValue": 0,
                "show": false,
                "thresholdLabels": false,
                "thresholdMarkers": true
              },
              "gridPos": {
                "h": 4,
                "w": 11,
                "x": 0,
                "y": 16
              },
              "id": 89,
              "interval": null,
              "links": [],
              "mappingType": 1,
              "mappingTypes": [
                {
                  "name": "value to text",
                  "value": 1
                },
                {
                  "name": "range to text",
                  "value": 2
                }
              ],
              "maxDataPoints": 100,
              "nullPointMode": "connected",
              "nullText": null,
              "postfix": "",
              "postfixFontSize": "50%",
              "prefix": "Prometheus scrapping status -",
              "prefixFontSize": "80%",
              "rangeMaps": [],
              "sparkline": {
                "fillColor": "#5195ce",
                "full": false,
                "lineColor": "#629e51",
                "show": false
              },
              "tableColumn": "",
              "targets": [
                {
                  "expr": "up{kubernetes_namespace=~\"$namespace\", kubernetes_pod_name=~\"$pod\"}",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "thresholds": "0,1",
              "title": "POD - $pod is UP",
              "type": "singlestat",
              "valueFontSize": "80%",
              "valueMaps": [
                {
                  "op": "=",
                  "text": "N/A",
                  "value": "null"
                },
                {
                  "op": "=",
                  "text": "down",
                  "value": "0"
                },
                {
                  "op": "=",
                  "text": "up",
                  "value": "1"
                }
              ],
              "valueName": "current"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "relates from the used memory how much is dedicated to JVM heap and non-heap. It is currently accurate for Springboot applications.",
              "fill": 0,
              "gridPos": {
                "h": 18,
                "w": 13,
                "x": 11,
                "y": 16
              },
              "id": 85,
              "legend": {
                "alignAsTable": true,
                "avg": true,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 2,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [
                {
                  "alias": "/JVM.*Heap.*/i",
                  "color": "#629e51",
                  "dashes": true,
                  "fill": 1,
                  "linewidth": 1,
                  "stack": "A"
                },
                {
                  "alias": "/Container.*/i",
                  "color": "#bf1b00",
                  "linewidth": 1
                },
                {
                  "alias": "Container Usage",
                  "linewidth": 4
                },
                {
                  "alias": "JVM Total Max",
                  "color": "#629e51"
                },
                {
                  "alias": "JVM Total Committed",
                  "color": "#3f6833"
                }
              ],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(jvm_memory_used_bytes{area=\"nonheap\", kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) or sum(jvm_memory_bytes_used{area=\"nonheap\", kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"})",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "JVM Non Heap used",
                  "refId": "B"
                },
                {
                  "expr": "sum(jvm_memory_used_bytes{area=\"heap\", kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) or sum(jvm_memory_bytes_used{area=\"heap\", kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "JVM Heap used",
                  "refId": "A"
                },
                {
                  "expr": "sum(jvm_memory_max_bytes{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) or sum(jvm_memory_bytes_max{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"})",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "JVM Total Max",
                  "refId": "J"
                },
                {
                  "expr": "sum(jvm_memory_committed_bytes{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) or sum(jvm_memory_bytes_committed{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "JVM Total Committed",
                  "refId": "G"
                },
                {
                  "expr": "sum(jvm_buffer_memory_used_bytes{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) or sum(jvm_buffer_pool_used_bytes{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"})",
                  "format": "time_series",
                  "instant": false,
                  "intervalFactor": 1,
                  "legendFormat": "JVM Buffer",
                  "refId": "F"
                },
                {
                  "expr": "sum(jvm_memory_pool_bytes_used{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}) ",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "JVM",
                  "refId": "H"
                },
                {
                  "expr": "max(container_memory_usage_bytes{namespace=\"$namespace\", pod_name=\"$pod\"})",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "Total memory usage for the Pod",
                  "refId": "I"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "JVM Memory breakdown for POD - $pod",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "decimals": null,
                  "format": "decbytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "Total time spent in GC related activities for  this pod. This is a rate.",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 11,
                "x": 0,
                "y": 20
              },
              "id": 8,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(jvm_gc_collection_seconds_sum{kubernetes_namespace=~\"^$namespace\", kubernetes_pod_name=\"$pod\"}[5m])) by (kubernetes_pod_name) or sum(rate(jvm_gc_pause_seconds_sum{kubernetes_namespace=~\"^$namespace\", kubernetes_pod_name=\"$pod\"}[5m])) by (kubernetes_pod_name)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "Time spent in GC",
                  "refId": "A"
                },
                {
                  "expr": "",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "legendFormat": "",
                  "refId": "B"
                },
                {
                  "expr": "rate(jvm_gc_pause_seconds_sum{kubernetes_namespace=~\"^$namespace\", kubernetes_pod_name=\"$pod\"}[5m])",
                  "format": "time_series",
                  "hide": true,
                  "intervalFactor": 1,
                  "refId": "C"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Time Spent rate in GC for POD - $pod",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "Gives a glimpse at the garbage collection rate of the pod.",
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 11,
                "x": 0,
                "y": 27
              },
              "id": 47,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(jvm_gc_collection_seconds_count{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}[5m]) or  rate(jvm_gc_pause_seconds_count{kubernetes_namespace=\"$namespace\", kubernetes_pod_name=\"$pod\"}[5m])",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "({{action}}, {{cause}}) or ({{gc}})",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Garbage Collection Rate for POD - $pod",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Pod Overview",
          "type": "row"
        },
        {
          "collapsed": true,
          "gridPos": {
            "h": 1,
            "w": 24,
            "x": 0,
            "y": 3
          },
          "id": 12,
          "panels": [
            {
              "columns": [],
              "description": "If pods are not up for scrapping, then measurements will not be available in the dashboard",
              "fontSize": "90%",
              "gridPos": {
                "h": 15,
                "w": 18,
                "x": 0,
                "y": 4
              },
              "id": 63,
              "links": [],
              "pageSize": null,
              "scroll": true,
              "showHeader": true,
              "sort": {
                "col": 0,
                "desc": true
              },
              "styles": [
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "pattern": "Time",
                  "thresholds": [],
                  "type": "date",
                  "unit": "short"
                },
                {
                  "alias": "Up for scrapping",
                  "colorMode": "cell",
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 0,
                  "mappingType": 1,
                  "pattern": "Value",
                  "thresholds": [
                    "0.4",
                    "0.6"
                  ],
                  "type": "string",
                  "unit": "short",
                  "valueMaps": [
                    {
                      "text": "up",
                      "value": "1"
                    },
                    {
                      "text": "down",
                      "value": "0"
                    }
                  ]
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "__name__",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "instance",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "job",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "kubernetes_namespace",
                  "thresholds": [],
                  "type": "hidden",
                  "unit": "short"
                },
                {
                  "alias": "",
                  "colorMode": null,
                  "colors": [
                    "rgba(245, 54, 54, 0.9)",
                    "rgba(237, 129, 40, 0.89)",
                    "rgba(50, 172, 45, 0.97)"
                  ],
                  "dateFormat": "YYYY-MM-DD HH:mm:ss",
                  "decimals": 2,
                  "mappingType": 1,
                  "pattern": "kubernetes_pod_name",
                  "thresholds": [],
                  "type": "string",
                  "unit": "short"
                }
              ],
              "targets": [
                {
                  "expr": "up{kubernetes_namespace=~\"^$namespace\"}",
                  "format": "table",
                  "instant": true,
                  "intervalFactor": 1,
                  "refId": "A"
                }
              ],
              "title": "Prometheus targets",
              "transform": "table",
              "type": "table"
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 6,
                "x": 18,
                "y": 4
              },
              "id": 20,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "scrape_duration_seconds{kubernetes_namespace=~\"^$namespace\"}",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{app}},{{kubernetes_pod_name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Prometheus scrape duration",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "s",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "fill": 1,
              "gridPos": {
                "h": 7,
                "w": 6,
                "x": 18,
                "y": 12
              },
              "id": 93,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "scrape_samples_scraped{kubernetes_namespace=~\"^$namespace\"}",
                  "format": "time_series",
                  "interval": "",
                  "intervalFactor": 1,
                  "legendFormat": "{{app}}, {{kubernetes_pod_name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Prometheus samples scraped",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "One can see the error logging rate of pods. Only for the pods that are scraped by Prometheus",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 19
              },
              "id": 95,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": true,
                "max": true,
                "min": true,
                "rightSide": true,
                "show": true,
                "total": false,
                "values": true
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "rate(log4j2_events_total{kubernetes_namespace=\"$namespace\", level!=\"info\"}[5m]) > 0",
                  "format": "time_series",
                  "intervalFactor": 1,
                  "legendFormat": "{{avq_app}},{{kubernetes_pod_name}},{{level}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Log4j Error logging rate (/sec)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "description": "Error rate over a configurable amount of time. These metrics only available for pods that are scraped by Prometheus",
              "fill": 1,
              "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 27
              },
              "id": 97,
              "legend": {
                "alignAsTable": true,
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "rightSide": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(http_server_requests_seconds_count{kubernetes_namespace=~\"$namespace\", status!~\"2..\"}[$__interval])) by (status, exception)",
                  "format": "time_series",
                  "interval": "5m",
                  "intervalFactor": 1,
                  "legendFormat": "aggregated - {{exception}}, {{status}}",
                  "refId": "A"
                },
                {
                  "expr": "rate(http_server_requests_seconds_count{kubernetes_namespace=~\"$namespace\", status!~\"2..\"}[$__interval])",
                  "format": "time_series",
                  "hide": false,
                  "interval": "5m",
                  "intervalFactor": 1,
                  "legendFormat": "{{avq_app}} - {{exception}} - {{status}}",
                  "refId": "B"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Rest calls - Error rate (/sec)",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "This panel is to compare the how high are the garbage collection rate for all the pods. This is currently accurate for only pods that are scrapped successfully by Prometheus.",
              "fill": 0,
              "gridPos": {
                "h": 14,
                "w": 12,
                "x": 0,
                "y": 35
              },
              "id": 87,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(rate(jvm_gc_collection_seconds_count{kubernetes_namespace=~\"^$namespace\"}[5m])) by (kubernetes_pod_name) or sum(rate(jvm_gc_pause_seconds_count{kubernetes_namespace=~\"^$namespace\"}[5m])) by (kubernetes_pod_name)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{kubernetes_pod_name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Garbage collection rate for all pods up for scrapping",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "ops",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            },
            {
              "aliasColors": {},
              "bars": false,
              "dashLength": 10,
              "dashes": false,
              "datasource": "DS-Prometheus",
              "description": "This panel compares the memory usage of all the pods in the project",
              "fill": 0,
              "gridPos": {
                "h": 14,
                "w": 12,
                "x": 12,
                "y": 35
              },
              "id": 99,
              "legend": {
                "avg": false,
                "current": false,
                "max": false,
                "min": false,
                "show": true,
                "total": false,
                "values": false
              },
              "lines": true,
              "linewidth": 1,
              "links": [],
              "nullPointMode": "null",
              "percentage": false,
              "pointradius": 5,
              "points": false,
              "renderer": "flot",
              "seriesOverrides": [],
              "spaceLength": 10,
              "stack": false,
              "steppedLine": false,
              "targets": [
                {
                  "expr": "sum(container_memory_usage_bytes{namespace=\"$namespace\", container_name=\"\"}) by (pod_name)",
                  "format": "time_series",
                  "hide": false,
                  "intervalFactor": 1,
                  "legendFormat": "{{pod_name}}",
                  "refId": "A"
                }
              ],
              "thresholds": [],
              "timeFrom": null,
              "timeRegions": [],
              "timeShift": null,
              "title": "Memory usage across all pods",
              "tooltip": {
                "shared": true,
                "sort": 0,
                "value_type": "individual"
              },
              "type": "graph",
              "xaxis": {
                "buckets": null,
                "mode": "time",
                "name": null,
                "show": true,
                "values": []
              },
              "yaxes": [
                {
                  "format": "bytes",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": "0",
                  "show": true
                },
                {
                  "format": "short",
                  "label": null,
                  "logBase": 1,
                  "max": null,
                  "min": null,
                  "show": true
                }
              ],
              "yaxis": {
                "align": false,
                "alignLevel": null
              }
            }
          ],
          "title": "Additional Detail Plots",
          "type": "row"
        }
      ],
      "refresh": false,
      "schemaVersion": 16,
      "style": "dark",
      "tags": [],
      "templating": {
        "list": [
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "",
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "namespace",
            "options": [],
            "query": "label_values(kube_namespace_labels, namespace)",
            "refresh": 1,
            "regex": "",
            "skipUrlSync": false,
            "sort": 1,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "label_values(up{kubernetes_namespace=\"$namespace\"}, app)",
            "hide": 0,
            "includeAll": false,
            "label": "Application",
            "multi": false,
            "name": "app",
            "options": [],
            "query": "label_values(up{kubernetes_namespace=\"$namespace\"}, app)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          },
          {
            "allValue": null,
            "current": {},
            "datasource": "DS-Prometheus",
            "definition": "",
            "hide": 0,
            "includeAll": false,
            "label": null,
            "multi": false,
            "name": "pod",
            "options": [],
            "query": "label_values(kube_pod_info{namespace=\"$namespace\"}, pod)",
            "refresh": 2,
            "regex": "",
            "skipUrlSync": false,
            "sort": 0,
            "tagValuesQuery": "",
            "tags": [],
            "tagsQuery": "",
            "type": "query",
            "useTags": false
          }
        ]
      },
      "time": {
        "from": "now-6h",
        "to": "now"
      },
      "timepicker": {
        "hidden": false,
        "refresh_intervals": [
          "5s",
          "10s",
          "30s",
          "1m",
          "5m",
          "15m",
          "30m",
          "1h",
          "2h",
          "1d"
        ],
        "time_options": [
          "5m",
          "15m",
          "1h",
          "6h",
          "12h",
          "24h",
          "2d",
          "7d",
          "30d"
        ]
      },
      "timezone": "",
      "title": "Topic: OpenShift Project",
      "uid": "acpr-project-dashboard",
      "version": 101
    }
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-alerts
  labels:
    acpr.avaloq.com/kind: prometheus-rules
    rule-type: infrastructure
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
data:
  avaloq.rules: |-
    groups:
      - name: grafana-alert-rules
        rules:
        - alert: VolumeSpaceUsage20%Free
          expr: 100 - 100 * ( kubelet_volume_stats_available_bytes{persistentvolumeclaim="grafana-lib-pvc"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim="grafana-lib-pvc"} ) > 80
          labels:
            severity: warning
          annotations:
            message: "{{ $labels.persistentvolumeclaim }} has less than 20% of free disk space ({{ $value }}% used)"
            summary: "Volume {{ $labels.persistentvolumeclaim }} is low on disk space"
        - alert: VolumeSpaceUsage15%Free
          expr: 100 - 100 * ( kubelet_volume_stats_available_bytes{persistentvolumeclaim="grafana-lib-pvc"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim="grafana-lib-pvc"} ) > 85
          labels:
            severity: critical
          annotations:
            message: "{{ $labels.persistentvolumeclaim }} has less than 15% of free disk space ({{ $value }}% used)"
            summary: "Volume {{ $labels.persistentvolumeclaim }} is low on disk space"
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-configuration
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
data:
  grafana.ini: |
    ##################### Grafana Configuration Defaults #####################
    #
    # Do not modify this file in grafana installs
    #
    # possible values : production, development
    app_mode = production
    # instance name, defaults to HOSTNAME environment variable value or hostname if HOSTNAME var is empty
    instance_name = ${HOSTNAME}
    #################################### Paths ###############################
    [paths]
    # Path to where grafana can store temp files, sessions, and the sqlite3 db (if that is used)
    #
    data = /var/lib/grafana
    #
    # Directory where grafana can store logs
    #
    logs = data/log
    #
    # Directory where grafana will automatically scan and look for plugins
    #
    plugins = data/plugins
    #
    # Folder that contains provisioning config files that grafana will apply on startup. Dashboards will be reloaded when the json files changes
    #
    provisioning = /etc/grafana/provisioning
    #################################### Server ##############################
    [server]
    # Protocol (http, https, socket)
    protocol = http
    # The ip address to bind to, empty will bind to all interfaces
    http_addr =
    # The http port  to use
    http_port = 3001
    # The public facing domain name used to access grafana from a browser
    domain = localhost
    # Redirect to correct domain if host header does not match domain
    # Prevents DNS rebinding attacks
    enforce_domain = false
    # The full public facing url
    root_url = %(protocol)s://%(domain)s:%(http_port)s/
    # Log web requests
    router_logging = false
    # the path relative working path
    static_root_path = public
    # enable gzip
    enable_gzip = false
    # https certs & key file
    cert_file =
    cert_key =
    # Unix socket path
    socket = /tmp/grafana.sock
    #################################### Database ############################
    [database]
    # You can configure the database connection by specifying type, host, name, user and password
    # as separate properties or as on string using the url property.
    # Either "mysql", "postgres" or "sqlite3", it's your choice
    type = sqlite3
    host = 127.0.0.1:3306
    name = grafana
    user = root
    # If the password contains # or ; you have to wrap it with triple quotes. Ex """#password;"""
    password =
    # Use either URL or the previous fields to configure the database
    # Example: mysql://user:secret@host:port/database
    url =
    # Max conn setting default is 0 (mean not set)
    max_idle_conn =
    max_open_conn =
    # For "postgres", use either "disable", "require" or "verify-full"
    # For "mysql", use either "true", "false", or "skip-verify".
    ssl_mode = disable
    ca_cert_path =
    client_key_path =
    client_cert_path =
    server_cert_name =
    # For "sqlite3" only, path relative to data_path setting
    path = grafana.db
    #################################### Session #############################
    [session]
    # Either "memory", "file", "redis", "mysql", "postgres", "memcache", default is "file"
    provider = file
    # Provider config options
    # memory: not have any config yet
    # file: session dir path, is relative to grafana data_path
    # redis: config like redis server e.g. `addr=127.0.0.1:6379,pool_size=100,db=grafana`
    # postgres: user=a password=b host=localhost port=5432 dbname=c sslmode=disable
    # mysql: go-sql-driver/mysql dsn config string, examples:
    #         `user:password@tcp(127.0.0.1:3306)/database_name`
    #         `user:password@unix(/var/run/mysqld/mysqld.sock)/database_name`
    # memcache: 127.0.0.1:11211
    provider_config = sessions
    # Session cookie name
    cookie_name = grafana_sess
    # If you use session in https only, default is false
    cookie_secure = false
    # Session life time, default is 86400
    session_life_time = 86400
    gc_interval_time = 86400
    #################################### Data proxy ###########################
    [dataproxy]
    # This enables data proxy logging, default is false
    logging = false
    #################################### Analytics ###########################
    [analytics]
    # Server reporting, sends usage counters to stats.grafana.org every 24 hours.
    # No ip addresses are being tracked, only simple counters to track
    # running instances, dashboard and error counts. It is very helpful to us.
    # Change this option to false to disable reporting.
    reporting_enabled = true
    # Set to false to disable all checks to https://grafana.com
    # for new versions (grafana itself and plugins), check is used
    # in some UI views to notify that grafana or plugin update exists
    # This option does not cause any auto updates, nor send any information
    # only a GET request to https://grafana.com to get latest versions
    check_for_updates = true
    # Google Analytics universal tracking code, only enabled if you specify an id here
    google_analytics_ua_id =
    # Google Tag Manager ID, only enabled if you specify an id here
    google_tag_manager_id =
    #################################### Security ############################
    [security]
    # default admin user, created on startup
    admin_user = admin
    # default admin password, can be changed before first start of grafana,  or in profile settings
    admin_password = admin
    # used for signing
    secret_key = SW2YcwTIb9zpOOhoPsMm
    # Auto-login remember days
    login_remember_days = 7
    cookie_username = grafana_user
    cookie_remember_name = grafana_remember
    # disable gravatar profile images
    disable_gravatar = false
    # data source proxy whitelist (ip_or_domain:port separated by spaces)
    data_source_proxy_whitelist =
    [snapshots]
    # snapshot sharing options
    external_enabled = true
    external_snapshot_url = https://snapshots-origin.raintank.io
    external_snapshot_name = Publish to snapshot.raintank.io
    # remove expired snapshot
    snapshot_remove_expired = true
    # remove snapshots after 90 days
    snapshot_TTL_days = 90
    #################################### Users ####################################
    [users]
    # disable user signup / registration
    allow_sign_up = true
    # Allow non admin users to create organizations
    allow_org_create = true
    # Set to true to automatically assign new users to the default organization (id 1)
    auto_assign_org = true
    # Default role new users will be automatically assigned (if auto_assign_org above is set to true)
    auto_assign_org_role = Viewer
    # Require email validation before sign up completes
    verify_email_enabled = false
    # Background text for the user field on the login page
    login_hint = email or username
    # Default UI theme ("dark" or "light")
    default_theme = dark
    [auth]
    # Set to true to disable (hide) the login form, useful if you use OAuth
    disable_login_form = true
    # Set to true to disable the signout link in the side menu. useful if you use auth.proxy
    disable_signout_menu = true
    #################################### Anonymous Auth ######################
    [auth.anonymous]
    # enable anonymous access
    enabled = false
    # specify organization name that should be used for unauthenticated users
    org_name = Main Org.
    # specify role for unauthenticated users
    org_role = Editor
    #################################### Github Auth #########################
    [auth.github]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    auth_url = https://github.com/login/oauth/authorize
    token_url = https://github.com/login/oauth/access_token
    api_url = https://api.github.com/user
    team_ids =
    allowed_organizations =
    #################################### Google Auth #########################
    [auth.google]
    enabled = false
    allow_sign_up = true
    client_id = some_client_id
    client_secret = some_client_secret
    scopes = https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email
    auth_url = https://accounts.google.com/o/oauth2/auth
    token_url = https://accounts.google.com/o/oauth2/token
    api_url = https://www.googleapis.com/oauth2/v1/userinfo
    allowed_domains =
    hosted_domain =
    #################################### Grafana.com Auth ####################
    # legacy key names (so they work in env variables)
    [auth.grafananet]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    allowed_organizations =
    [auth.grafana_com]
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    allowed_organizations =
    #################################### Generic OAuth #######################
    [auth.generic_oauth]
    name = OAuth
    enabled = false
    allow_sign_up = true
    client_id = some_id
    client_secret = some_secret
    scopes = user:email
    auth_url =
    token_url =
    api_url =
    team_ids =
    allowed_organizations =
    #################################### Basic Auth ##########################
    [auth.basic]
    enabled = false
    #################################### Auth Proxy ##########################
    [auth.proxy]
    enabled = true
    header_name = X-Forwarded-User
    header_property = username
    auto_sign_up = true
    ldap_sync_ttl = 60
    whitelist =
    #################################### Auth LDAP ###########################
    [auth.ldap]
    enabled = false
    config_file = /etc/grafana/ldap.toml
    allow_sign_up = true
    #################################### SMTP / Emailing #####################
    [smtp]
    enabled = false
    host = localhost:25
    user =
    # If the password contains # or ; you have to wrap it with trippel quotes. Ex """#password;"""
    password =
    cert_file =
    key_file =
    skip_verify = false
    from_address = admin@grafana.localhost
    from_name = Grafana
    [emails]
    welcome_email_on_sign_up = false
    templates_pattern = emails/*.html
    #################################### Logging ##########################
    [log]
    # Either "console", "file", "syslog". Default is console and  file
    # Use space to separate multiple modes, e.g. "console file"
    mode = console file
    # Either "debug", "info", "warn", "error", "critical", default is "info"
    level = info
    # optional settings to set different levels for specific loggers. Ex filters = sqlstore:debug
    filters =
    # For "console" mode only
    [log.console]
    level =
    # log line format, valid options are text, console and json
    format = console
    # For "file" mode only
    [log.file]
    level =
    # log line format, valid options are text, console and json
    format = text
    # This enables automated log rotate(switch of following options), default is true
    log_rotate = true
    # Max line number of single file, default is 1000000
    max_lines = 1000000
    # Max size shift of single file, default is 28 means 1 << 28, 256MB
    max_size_shift = 28
    # Segment log daily, default is true
    daily_rotate = true
    # Expired days of log file(delete after max days), default is 7
    max_days = 7
    [log.syslog]
    level =
    # log line format, valid options are text, console and json
    format = text
    # Syslog network type and address. This can be udp, tcp, or unix. If left blank, the default unix endpoints will be used.
    network =
    address =
    # Syslog facility. user, daemon and local0 through local7 are valid.
    facility =
    # Syslog tag. By default, the process' argv[0] is used.
    tag =
    #################################### AMQP Event Publisher ################
    [event_publisher]
    enabled = false
    rabbitmq_url = amqp://localhost/
    exchange = grafana_events
    #################################### Dashboard JSON files ################
    [dashboards.json]
    enabled = false
    path = /var/lib/grafana/dashboards
    #################################### Usage Quotas ########################
    [quota]
    enabled = false
    #### set quotas to -1 to make unlimited. ####
    # limit number of users per Org.
    org_user = 10
    # limit number of dashboards per Org.
    org_dashboard = 100
    # limit number of data_sources per Org.
    org_data_source = 10
    # limit number of api_keys per Org.
    org_api_key = 10
    # limit number of orgs a user can create.
    user_org = 10
    # Global limit of users.
    global_user = -1
    # global limit of orgs.
    global_org = -1
    # global limit of dashboards
    global_dashboard = -1
    # global limit of api_keys
    global_api_key = -1
    # global limit on number of logged in users.
    global_session = -1
    #################################### Alerting ############################
    [alerting]
    # Disable alerting engine & UI features
    enabled = false
    # Makes it possible to turn off alert rule execution but alerting UI is visible
    execute_alerts = false
    #################################### Internal Grafana Metrics ############
    # Metrics available at HTTP API Url /api/metrics
    [metrics]
    enabled           = true
    interval_seconds  = 10
    # Send internal Grafana metrics to graphite
    [metrics.graphite]
    # Enable by setting the address setting (ex localhost:2003)
    address =
    prefix = prod.grafana.%(instance_name)s.
    [grafana_net]
    url = https://grafana.com
    [grafana_com]
    url = https://grafana.com
    #################################### External Image Storage ##############
    [external_image_storage]
    # You can choose between (s3, webdav)
    provider =
    [external_image_storage.s3]
    bucket_url =
    access_key =
    secret_key =
    [external_image_storage.webdav]
    url =
    username =
    password =
    public_url =
---
kind: ConfigMap
apiVersion: v1
data:
  auth: ${grafana-configuration/htpasswd}
metadata:
  name: grafana-htpasswd
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-provisioning
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
data:
  dashboard-provisioning.yaml: |
    apiVersion: 1
    providers:
    - name: 'dashboard-provisioning-infrastructure'
      orgId: 1
      folder: 'ACPR Infrastructure'
      type: file
      disableDeletion: false
      updateIntervalSeconds: 10
      options:
        path: /etc/grafana/dashboards/infrastructure
    - name: 'dashboard-provisioning-application'
      orgId: 1
      folder: 'Avaloq Applications'
      type: file
      disableDeletion: false
      updateIntervalSeconds: 10
      options:
        path: /etc/grafana/dashboards/application
  additional-dashboard-provisioning.yaml: ${grafana-configuration/additional-dashboard-provisioning.yaml}
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/component: monitoring
    avaloq.com/app: grafana
    avaloq.com/zone: core-internal
  name: grafana
spec:
  replicas: ${AVALOQ_GRAFANA_REPLICAS}
  selector:
    matchLabels:
      avaloq.com/app: grafana
  template:
    metadata:
      labels:
        app.kubernetes.io/component: monitoring
        avaloq.com/app: grafana
        avaloq.com/zone: core-internal
      name: grafana
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchLabels:
                avaloq.com/app: grafana
            topologyKey: ${AVALOQ_GRAFANA_PODANTIAFFINITY_TOPOLOGY_KEY}
      initContainers:
      - command:
        - sh
        - -c
        - |-
          if ! /usr/bin/sqlite3 /var/lib/grafana/grafana.db "select slug from dashboard where uid = 'nErXDvCkzz';" | grep 'sandbox'; then
            /usr/bin/grafana-server -config=/etc/grafana/grafana.ini &
            sleep 3
            /usr/bin/curl -H "X-Forwarded-User: admin" -H "Accept: application/json" -H "Content-Type: application/json" http://localhost:3001/api/folders -X POST -d '{"uid": "nErXDvCkzz", "title": "Sandbox (writable)"}'
            /usr/bin/curl -H "X-Forwarded-User: admin" -H "Accept: application/json" -H "Content-Type: application/json" http://localhost:3001/api/folders/nErXDvCkzz/permissions -X POST -d '{"items": [{"role": "Viewer","permission": 2},{"role": "Editor","permission": 2}]}'
            kill $(pgrep -f grafana-server)
          fi
        image: ${AVALOQ_REDHAT_CONTAINER_IMAGE_REGISTRY}${AVALOQ_GRAFANA_CONTAINER_IMAGE}
        name: grafana-init-db
        resources:
          limits:
            cpu: ${AVALOQ_GRAFANA_RESOURCES_LIMIT_CPU}
            memory: ${AVALOQ_GRAFANA_RESOURCES_LIMIT_MEMORY}
          requests:
            cpu: ${AVALOQ_GRAFANA_RESOURCES_REQUEST_CPU}
            memory: ${AVALOQ_GRAFANA_RESOURCES_REQUEST_MEMORY}
        volumeMounts:
        - mountPath: /var/lib/grafana
          name: grafana-lib-pvc
        - mountPath: /etc/grafana
          name: grafana-configuration
      containers:
      - image: ${AVALOQ_REDHAT_CONTAINER_IMAGE_REGISTRY}${AVALOQ_GRAFANA_CONTAINER_IMAGE}
        imagePullPolicy: ${AVALOQ_GRAFANA_CONTAINER_IMAGE_PULL_POLICY}
        name: grafana
        args:
        - -config=/etc/grafana/grafana.ini
        ports:
        - containerPort: 3000
          name: direct
          protocol: TCP
        resources:
          limits:
            cpu: ${AVALOQ_GRAFANA_RESOURCES_LIMIT_CPU}
            memory: ${AVALOQ_GRAFANA_RESOURCES_LIMIT_MEMORY}
          requests:
            cpu: ${AVALOQ_GRAFANA_RESOURCES_REQUEST_CPU}
            memory: ${AVALOQ_GRAFANA_RESOURCES_REQUEST_MEMORY}
        securityContext:
          privileged: '${AVALOQ_GRAFANA_SECURITYCONTEXT_PRIVILEGED}'
          runAsUser: ${AVALOQ_GRAFANA_SECURITYCONTEXT_RUNASUSER}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/grafana
          name: grafana-configuration
        - mountPath: /var/lib/grafana
          name: grafana-lib-pvc
        - mountPath: /etc/grafana/provisioning/datasources
          name: grafana-datasource
        - mountPath: /etc/grafana/provisioning/dashboards
          name: grafana-provisioning
        - mountPath: /etc/grafana/dashboards
          name: grafana-dashboards-volume
      - args:
        - -provider=openshift
        - -https-address=:8443
        - -http-address=
        - -email-domain=*
        - -upstream=http://localhost:3001
        - -tls-cert=/etc/tls/private/tls.crt
        - -tls-key=/etc/tls/private/tls.key
        - -client-secret-file=/var/run/secrets/kubernetes.io/serviceaccount/token
        - -cookie-secret-file=/etc/proxy/secrets/session_secret
        - -openshift-service-account=grafana
        - -openshift-ca=/etc/pki/tls/cert.pem
        - -openshift-ca=/var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        - -skip-auth-regex=^/metrics
        - -skip-auth-regex=^/api/health
        - -cookie-expire=4h
        - '-display-htpasswd-form=${AVALOQ_GRAFANA_SHOW_HTPASSWD_FORM}'
        - -htpasswd-file=/etc/proxy/htpasswd/auth
        image: ${AVALOQ_REDHAT_CONTAINER_IMAGE_REGISTRY}${AVALOQ_GRAFANA_PROXY_CONTAINER_IMAGE}
        imagePullPolicy: ${AVALOQ_GRAFANA_CONTAINER_IMAGE_PULL_POLICY}
        name: grafana-proxy
        ports:
        - containerPort: 8443
          name: proxy
          protocol: TCP
        resources:
          limits:
            cpu: ${AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_CPU}
            memory: ${AVALOQ_GRAFANA_PROXY_RESOURCES_LIMIT_MEMORY}
          requests:
            cpu: ${AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_CPU}
            memory: ${AVALOQ_GRAFANA_PROXY_RESOURCES_REQUEST_MEMORY}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/tls/private
          name: grafana-tls
        - mountPath: /etc/proxy/secrets
          name: grafana-session-secret
        - mountPath: /etc/proxy/htpasswd
          name: grafana-htpasswd
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: grafana
      serviceAccountName: grafana
      terminationGracePeriodSeconds: 30
      nodeSelector:
        ${AVALOQ_GRAFANA_NODE_SELECTOR_KEY}: '${AVALOQ_GRAFANA_NODE_SELECTOR_VALUE}'
      volumes:
      - name: grafana-configuration
        configMap:
          defaultMode: 420
          name: grafana-configuration
      - name: grafana-lib-pvc
        persistentVolumeClaim:
          claimName: grafana-lib-pvc
      - name: grafana-datasource
        secret:
          defaultMode: 420
          secretName: grafana-datasource
      - name: grafana-provisioning
        configMap:
          defaultMode: 420
          name: grafana-provisioning
      - name: grafana-dashboards-volume
        persistentVolumeClaim:
          claimName: grafana-dashboards-volume
      - name: grafana-tls
        secret:
          defaultMode: 420
          secretName: grafana-tls
      - name: grafana-session-secret
        secret:
          defaultMode: 420
          secretName: grafana-session-secret
      - name: grafana-htpasswd
        configMap:
          defaultMode: 420
          name: grafana-htpasswd
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: grafana-dashboard-provisioner
  labels:
    avaloq.com/app: grafana-dashboard-provisioner
    app.kubernetes.io/component: monitoring
    avaloq.com/zone: core-internal
spec:
  replicas: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_REPLICAS}
  selector:
    matchLabels:
      avaloq.com/app: grafana-dashboard-provisioner
  strategy:
    type: Recreate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: '9090'
        prometheus.io/scheme: http
        prometheus.io/scrape: 'true'
      labels:
        app.kubernetes.io/component: monitoring
        avaloq.com/app: grafana-dashboard-provisioner
        avaloq.com/zone: core-internal
    spec:
      serviceAccountName: grafana-dashboard-provisioner
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchLabels:
                avaloq.com/app: grafana-dashboard-provisioner
            topologyKey: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_PODANTIAFFINITY_TOPOLOGY_KEY}
      containers:
      - name: grafana-dashboard-provisioner
        image: ${AVALOQ_CONTAINER_IMAGE_REGISTRY}${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_CONTAINER_IMAGE}
        env:
        - name: WATCHED_NAMESPACE
          value: '*'
        - name: DASHBOARD_TYPES
          value: 'infrastructure,application${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_ADDITIONAL_DASHBOARD_TYPES}'
        - name: UNIFY_DASHBOARD_TYPES
          value: application
        - name: PROCESS_DASHBOARD_TYPES
          value: application
        - name: FULL_RECONCILIATION_INTERVAL_S
          value: '3600'
        - name: COLORS
          value: 'false'
        - name: METRICS
          value: 'true'
        - name: METRICS_JVM
          value: 'true'
        - name: METRICS_PORT
          value: '9090'
        ports:
        - containerPort: 9090
          name: direct
          protocol: TCP
        resources:
          limits:
            cpu: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_CPU}
            memory: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_LIMIT_MEMORY}
          requests:
            cpu: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_CPU}
            memory: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_RESOURCES_REQUEST_MEMORY}
        securityContext:
          privileged: '${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_SECURITYCONTEXT_PRIVILEGED}'
          runAsUser: ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_SECURITYCONTEXT_RUNASUSER}
        volumeMounts:
        - mountPath: /opt/avaloq/grafana/dashboards
          name: grafana-dashboards-volume
      nodeSelector:
        ${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_NODE_SELECTOR_KEY}: '${AVALOQ_GRAFANA_DASHBOARD_PROVISIONER_NODE_SELECTOR_VALUE}'
      volumes:
      - name: grafana-dashboards-volume
        persistentVolumeClaim:
          claimName: grafana-dashboards-volume
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: grafana-route
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
spec:
  ingress:
  - ports:
    - port: 8443
      protocol: TCP
    from:
    - namespaceSelector:
        matchLabels:
          network.openshift.io/policy-group: ingress
  podSelector:
    matchLabels:
      avaloq.com/app: grafana
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: prometheus-dashboardprovisioner
  labels:
    avaloq.com/app: grafana-dashboard-provisioner
    app.kubernetes.io/component: monitoring
spec:
  ingress:
  - ports:
    - port: 9090
      protocol: TCP
    from:
    - podSelector:
        matchLabels:
          avaloq.com/app: prometheus
  podSelector:
    matchLabels:
      avaloq.com/app: grafana-dashboard-provisioner
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: grafana-dashboards-volume
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
spec:
  accessModes:
  - ${AVALOQ_GRAFANA_PVC_STORAGE_ACCESSMODE_DASHBOARD}
  resources:
    requests:
      storage: ${AVALOQ_GRAFANA_PVC_STORAGE_REQUEST_DASHBOARD}
  storageClassName: ${AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_DASHBOARD}
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: grafana-lib-pvc
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
spec:
  accessModes:
  - ${AVALOQ_GRAFANA_PVC_STORAGE_ACCESSMODE_LIBRARY}
  resources:
    requests:
      storage: ${AVALOQ_GRAFANA_PVC_STORAGE_REQUEST_LIBRARY}
  storageClassName: ${AVALOQ_GRAFANA_PVC_STORAGE_CLASSNAME_LIBRARY}
---
apiVersion: v1
kind: Route
metadata:
  name: grafana
  annotations:
    haproxy.router.openshift.io/timeout: 600s
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
spec:
  host: ${AVALOQ_GRAFANA_ROUTE_HOSTNAME}
  port:
    targetPort: grafana-proxy
  tls:
    insecureEdgeTerminationPolicy: Redirect
    termination: reencrypt
  to:
    kind: Service
    name: grafana-proxy
    weight: 100
  wildcardPolicy: None
---
kind: Secret
apiVersion: v1
stringData:
  prometheus-ds.yaml: ${grafana-configuration/grafana-datasource.yml}
metadata:
  name: grafana-datasource
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
type: Opaque
---
kind: Secret
apiVersion: v1
stringData:
  session_secret: ${AVALOQ_GRAFANA_SESSION_SECRET}
metadata:
  name: grafana-session-secret
  labels:
    app.kubernetes.io/component: monitoring
type: Opaque
---
apiVersion: v1
kind: Service
metadata:
  labels:
    avaloq.com/app: grafana-dashboard-provisioner
    app.kubernetes.io/component: monitoring
  name: grafana-dashboard-provisioner-direct
spec:
  ports:
  - name: grafana-dashboard-provisioner-direct
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    avaloq.com/app: grafana-dashboard-provisioner
  sessionAffinity: None
  type: ClusterIP
---
apiVersion: v1
kind: Service
metadata:
  labels:
    avaloq.com/app: grafana
    app.kubernetes.io/component: monitoring
  name: grafana-proxy
  annotations:
    service.alpha.openshift.io/serving-cert-secret-name: grafana-tls
spec:
  ports:
  - name: grafana-proxy
    port: 443
    protocol: TCP
    targetPort: 8443
  selector:
    avaloq.com/app: grafana
  sessionAffinity: None
  type: ClusterIP
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: grafana
  labels:
    app.kubernetes.io/component: monitoring
  annotations:
    serviceaccounts.openshift.io/oauth-redirectreference.grafana: '{"kind":"OAuthRedirectReference","apiVersion":"v1","reference":{"kind":"Route","name":"grafana"}}'
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: grafana-dashboard-provisioner
  labels:
    app.kubernetes.io/component: monitoring
